<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Wenluo ZHang" />

<meta name="date" content="2024-12-05" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Wenluo ZHang</h4>
<h4 class="date">2024-12-05</h4>



<div id="hw-1" class="section level1">
<h1>HW 1</h1>
<div id="exercise-3.4" class="section level2">
<h2>Exercise 3.4</h2>
<p>The Rayleigh density [156, Ch. 18] is given by: <span class="math display">\[
f(x) = \frac{x}{\sigma^2} e^{-x^2 / (2\sigma^2)}, \quad x \geq 0, \,
\sigma &gt; 0.
\]</span> Develop an algorithm to generate random samples from a
Rayleigh<span class="math inline">\((\sigma)\)</span> distribution.
Generate Rayleigh<span class="math inline">\((\sigma)\)</span> samples
for several choices of <span class="math inline">\(\sigma &gt;
0\)</span> and check that the mode of the generated samples is close to
the theoretical mode <span class="math inline">\(\sigma\)</span> (check
the histogram).</p>
<div id="solution" class="section level3">
<h3>Solution:</h3>
<p>The CDF is <span class="math display">\[F(x) = 1 -
e^{-\frac{x^2}{2\sigma^2}}, \quad x \geq 0\]</span> Inverse function is
<span class="math display">\[F^{-1}(u) = \sigma \sqrt{-2 \ln(1 - u)},
\quad u \in (0, 1)\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)<span class="co">#generate random number</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>Rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma){</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u)) <span class="co">#Inverse transform algorithm</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="fu">hist</span>(x,<span class="at">breaks=</span><span class="dv">100</span>,<span class="at">prob =</span> <span class="cn">TRUE</span>)<span class="co">#plot density </span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  </span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="co">#title</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">&quot;usr&quot;</span>)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x =</span> usr[<span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.3</span> <span class="sc">*</span> (usr[<span class="dv">2</span>] <span class="sc">-</span> usr[<span class="dv">1</span>]), </span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>     <span class="at">y =</span> usr[<span class="dv">4</span>] <span class="sc">-</span> <span class="fl">0.3</span> <span class="sc">*</span> (usr[<span class="dv">4</span>] <span class="sc">-</span> usr[<span class="dv">3</span>]), </span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>     <span class="fu">expression</span>(<span class="fu">f</span>(x) <span class="sc">==</span> <span class="fu">frac</span>(x, sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> e<span class="sc">^</span>{<span class="sc">-</span><span class="fu">frac</span>(x<span class="sc">^</span><span class="dv">2</span>, <span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)} <span class="sc">*</span> <span class="st">&quot;,&quot;</span> <span class="sc">~</span> x <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;,&quot;</span>))</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x =</span> usr[<span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.13</span> <span class="sc">*</span> (usr[<span class="dv">2</span>] <span class="sc">-</span> usr[<span class="dv">1</span>]), </span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>     <span class="at">y =</span> usr[<span class="dv">4</span>] <span class="sc">-</span> <span class="fl">0.3</span> <span class="sc">*</span> (usr[<span class="dv">4</span>] <span class="sc">-</span> usr[<span class="dv">3</span>]),  <span class="fu">substitute</span>(sigma <span class="sc">==</span> sigma_val, <span class="fu">list</span>(<span class="at">sigma_val =</span> sigma)))</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  </span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, .<span class="dv">01</span>) </span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>  <span class="fu">lines</span>(y, (y <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>))) <span class="co"># plot oracle density function</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>}</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="fu">Rayleigh</span>(<span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">Rayleigh</span>(<span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">Rayleigh</span>(<span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can find that the mode of the generated samples is close to the
theoretical mode Ïƒ.</p>
</div>
</div>
</div>
<div id="hw-2" class="section level1">
<h1>HW 2</h1>
<div id="excercise-3.11" class="section level2">
<h2>Excercise 3.11</h2>
<p>Generate a random sample of size 1000 from a normal location mixture.
The components of the mixture have <span class="math inline">\(N(0,
1)\)</span> and <span class="math inline">\(N(3, 1)\)</span>
distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 =
1 - p_1\)</span>.</p>
<p>Graph the histogram of the sample with the density superimposed, for
<span class="math inline">\(p_1 = 0.75\)</span>. Repeat with different
values for <span class="math inline">\(p_1\)</span> and observe whether
the empirical distribution of the mixture appears to be bimodal. Make a
conjecture about the values of <span class="math inline">\(p_1\)</span>
that produce bimodal mixtures.</p>
<div id="solution-1" class="section level3">
<h3>Solution:</h3>
<p>First generate a random <span class="math inline">\(a\)</span> number
between 0 and 1. If <span class="math inline">\(a \leq p_1\)</span>,
then generate <span class="math inline">\(x\)</span> with <span class="math inline">\(N(0, 1)\)</span> otherwise generate <span class="math inline">\(x\)</span> with <span class="math inline">\(3+N(0,1)\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>mixgauss <span class="ot">&lt;-</span><span class="cf">function</span>(p,n){</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#generate random number</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    <span class="cf">if</span> (a <span class="sc">&lt;</span> p){  <span class="co">#check if a &lt; p1</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>    }</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    }</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  }</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>}</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#par(mfrow = c(2, 2))</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">mixgauss</span>(<span class="fl">0.65</span>,n),<span class="at">breaks=</span><span class="dv">150</span>,<span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="st">&quot;Mixed Gaussian Distribution, &quot;</span> <span class="sc">~</span> p[<span class="dv">1</span>] <span class="sc">==</span> <span class="fl">0.65</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">mixgauss</span>(<span class="fl">0.7</span>,n),<span class="at">breaks=</span><span class="dv">150</span>,<span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="st">&quot;Mixed Gaussian Distribution, &quot;</span> <span class="sc">~</span> p[<span class="dv">1</span>] <span class="sc">==</span> <span class="fl">0.7</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">mixgauss</span>(<span class="fl">0.75</span>,n),<span class="at">breaks=</span><span class="dv">150</span>,<span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="st">&quot;Mixed Gaussian Distribution, &quot;</span> <span class="sc">~</span> p[<span class="dv">1</span>] <span class="sc">==</span> <span class="fl">0.75</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">mixgauss</span>(<span class="fl">0.8</span>,n),<span class="at">breaks=</span><span class="dv">150</span>,<span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="st">&quot;Mixed Gaussian Distribution, &quot;</span> <span class="sc">~</span> p[<span class="dv">1</span>] <span class="sc">==</span> <span class="fl">0.8</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can observe that when <span class="math inline">\(p_1 \leq
0.7\)</span>, the empirical distribution of the mixture appears to be
bimodal. So we may conjecture that when <span class="math inline">\(p_1
\in [0.3,0.7]\)</span> the distribution is bimodal.</p>
</div>
</div>
<div id="excercise-3.20" class="section level2">
<h2>Excercise 3.20</h2>
<p>A compound Poisson process is a stochastic process <span class="math inline">\(\{X(t), t \geq 0\}\)</span> that can be
represented as the random sum <span class="math display">\[
X(t) = \sum_{i=1}^{N(t)} Y_i, \quad t \geq 0,
\]</span> where <span class="math inline">\(\{N(t), t \geq 0\}\)</span>
is a Poisson process and <span class="math inline">\(Y_1, Y_2,
\dots\)</span> are i.i.d. and independent of <span class="math inline">\(\{N(t), t \geq 0\}\)</span>.</p>
<p>Write a program to simulate a compound Poisson<span class="math inline">\((\lambda)\)</span>â€“Gamma process (where <span class="math inline">\(Y\)</span> has a Gamma distribution). Estimate the
mean and variance of <span class="math inline">\(X(10)\)</span> for
several choices of the parameters and compare with the theoretical
values.</p>
<p><strong>Hint</strong>: Show that: <span class="math display">\[
E[X(t)] = \lambda t E[Y_1] \quad \text{and} \quad \text{Var}(X(t)) =
\lambda t E[Y_1^2].
\]</span></p>
<div id="solution-2" class="section level3">
<h3>Solution:</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>X<span class="ot">&lt;-</span> <span class="cf">function</span>(t){<span class="co">#generate compound Poisson process</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>t)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  result <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>    result <span class="ot">=</span> result <span class="sc">+</span> <span class="fu">rgamma</span>(<span class="dv">1</span>,<span class="at">shape =</span> alpha,<span class="at">rate =</span> beta)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  }</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>}</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>  data[i] <span class="ot">=</span> <span class="fu">X</span>(<span class="dv">10</span>)</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>}</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>{</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;When lambda = &quot;</span>,lambda,<span class="st">&quot;alpha = &quot;</span>,alpha,<span class="st">&quot;beta = &quot;</span>,beta,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The mean of X(10) is&quot;</span>, <span class="fu">mean</span>(data),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The variance of X(10) is&quot;</span>, <span class="fu">var</span>(data),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Î»tE[Y_1] = &quot;</span>, lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>alpha<span class="sc">/</span>beta,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Î»tE[Y_1^2] = &quot;</span>, lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>alpha<span class="sc">*</span>(beta<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>beta<span class="sc">^</span><span class="dv">2</span>,<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)}</span></code></pre></div>
<pre><code>## When lambda =  0.5 alpha =  2 beta =  2 
## The mean of X(10) is 4.997442 
## The variance of X(10) is 7.398454 
## Î»tE[Y_1] =  5 
## Î»tE[Y_1^2] =  7.5</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">#The second set of parameters </span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  data[i] <span class="ot">=</span> <span class="fu">X</span>(<span class="dv">10</span>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>{</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;When lambda = &quot;</span>,lambda,<span class="st">&quot;alpha = &quot;</span>,alpha,<span class="st">&quot;beta = &quot;</span>,beta,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The mean of X(10) is&quot;</span>, <span class="fu">mean</span>(data),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The variance of X(10) is&quot;</span>, <span class="fu">var</span>(data),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Î»tE[Y_1] = &quot;</span>, lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>alpha<span class="sc">/</span>beta,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Î»tE[Y_1^2] = &quot;</span>, lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>alpha<span class="sc">*</span>(alpha<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>beta<span class="sc">^</span><span class="dv">2</span>,<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)}</span></code></pre></div>
<pre><code>## When lambda =  1 alpha =  1 beta =  2 
## The mean of X(10) is 5.002696 
## The variance of X(10) is 5.025009 
## Î»tE[Y_1] =  5 
## Î»tE[Y_1^2] =  5</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co">#The third set of parameters</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  data[i] <span class="ot">=</span> <span class="fu">X</span>(<span class="dv">10</span>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>}</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>{</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;When lambda = &quot;</span>,lambda,<span class="st">&quot;alpha = &quot;</span>,alpha,<span class="st">&quot;beta = &quot;</span>,beta,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The mean of X(10) is&quot;</span>, <span class="fu">mean</span>(data),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The variance of X(10) is&quot;</span>, <span class="fu">var</span>(data),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Î»tE[Y_1] = &quot;</span>, lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>alpha<span class="sc">/</span>beta,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Î»tE[Y_1^2] = &quot;</span>, lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>alpha<span class="sc">*</span>(alpha<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>beta<span class="sc">^</span><span class="dv">2</span>,<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)}</span></code></pre></div>
<pre><code>## When lambda =  1 alpha =  2 beta =  0.5 
## The mean of X(10) is 39.93368 
## The variance of X(10) is 242.2186 
## Î»tE[Y_1] =  40 
## Î»tE[Y_1^2] =  240</code></pre>
<p>We can observe that the estimation is close to theoretical number,
which follows the equation<span class="math display">\[E[X(t)] = \lambda
t E[Y_1] \quad \text{and} \quad \text{Var}(X(t)) = \lambda t E[Y_1^2].
\]</span></p>
</div>
</div>
<div id="excercise-5.4" class="section level2">
<h2>Excercise 5.4</h2>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3)
cdf, and use the function to estimate F(x) for x = 0.1, 0.2,â€¦, 0.9.
Compare the estimates with the values returned by the pbeta function in
R</p>
<div id="solution-3" class="section level3">
<h3>Solution</h3>
<p>Beta(3, 3)åˆ†å¸ƒçš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆCDFï¼‰ä¸ºï¼š</p>
<p><span class="math display">\[
F(x) = \int_0^x \frac{u^{2} (1-u)^{2}}{B(3, 3)} \, du \quad \text{for }
0 \leq x \leq 1
\]</span> æ‰€ä»¥ <span class="math display">\[F(x)=
\mathbb{E}_{U}[x\frac{U^{2} (1-U)^{2}}{B(3, 3)}], U\sim U(0,x)
\]</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>beta_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x,a,b){<span class="co">#æ¨¡ç‰¹å¡ç½—æ¨¡æ‹Ÿbetaåˆ†å¸ƒcdf</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fl">1e4</span>; u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span>x)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  estimation <span class="ot">&lt;-</span> <span class="fu">mean</span>(x<span class="sc">*</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">beta</span>(a,b)) </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="fu">return</span> (estimation)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>}</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>)){</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;x=&quot;</span>,x,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š&quot;</span>,<span class="fu">beta_cdf</span>(x,<span class="dv">3</span>,<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;çœŸå®žç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š&quot;</span>,<span class="fu">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## x= 0.1 
## è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.008662193 
## çœŸå®žç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.00856 
## x= 0.2 
## è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.05870375 
## çœŸå®žç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.05792 
## x= 0.3 
## è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.1624 
## çœŸå®žç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.16308 
## x= 0.4 
## è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.3146799 
## çœŸå®žç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.31744 
## x= 0.5 
## è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.5020387 
## çœŸå®žç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.5 
## x= 0.6 
## è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.6853883 
## çœŸå®žç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.68256 
## x= 0.7 
## è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.8357089 
## çœŸå®žç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.83692 
## x= 0.8 
## è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.9443938 
## çœŸå®žç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.94208 
## x= 0.9 
## è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.994433 
## çœŸå®žç´¯è®¡åˆ†å¸ƒå‡½æ•°å€¼ï¼š 0.99144</code></pre>
</div>
</div>
<div id="excercise-5.9" class="section level2">
<h2>Excercise 5.9</h2>
<p>The Rayleigh density is given by <span class="math display">\[
f(x) = \frac{x}{\sigma^2} e^{-\frac{x^2}{2\sigma^2}}, \quad x \geq 0,
\sigma &gt; 0.
\]</span> Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution using antithetic
variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X + X&#39;}{2}\)</span> compared with $ $
for independent <span class="math inline">\(X_1, X_2\)</span>? ###
Solution</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)<span class="co">#generate random number</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>Rayleigh_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma){</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u)) <span class="co">#Inverse transform algorithm</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>}</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>Rayleigh_antithetic <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma){ <span class="co">#generated by antithetic variables</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(u)) </span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>}</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>Rayleigh_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma){</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>}</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="fu">rownames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;var((X + X</span><span class="sc">\&#39;</span><span class="st">)/ 2)&#39;</span> , <span class="st">&#39;var((X_1 + X_2)/ 2)&#39;</span>, <span class="st">&#39;reduction&#39;</span>)</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Ïƒ=1&quot;</span>, <span class="st">&quot;Ïƒ=2&quot;</span>, <span class="st">&quot;Ïƒ=3&quot;</span>)</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)){</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data)){</span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>    data[i,j] <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">Rayleigh_1</span>(j)<span class="sc">+</span><span class="fu">Rayleigh_antithetic</span>(j))<span class="sc">/</span><span class="dv">4</span>}</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a>    data[i,j] <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">Rayleigh_1</span>(j)<span class="sc">+</span><span class="fu">Rayleigh_2</span>(j))<span class="sc">/</span><span class="dv">4</span>}</span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">3</span>){</span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a>    data[i,j] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>data[<span class="dv">1</span>,j]<span class="sc">/</span>data[<span class="dv">2</span>,j]}</span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a>  }</span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a>}</span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a>data</span></code></pre></div>
<pre><code>##                            Ïƒ=1        Ïƒ=2       Ïƒ=3
## var((X + X&#39;)/ 2)    0.01114827 0.04459308 0.1003344
## var((X_1 + X_2)/ 2) 0.21512130 0.85821382 1.9210042
## reduction           0.94817682 0.94803966 0.9477698</code></pre>
<p>æ–¹å·®å‡å°‘äº†95%</p>
</div>
<div id="excercise-5.13" class="section level2">
<h2>Excercise 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are `closeâ€™ to <span class="math display">\[
g(x) = \frac{x^2}{\sqrt{2\pi}} e^{-x^2/2}, \quad x &gt; 1.
\]</span> Which of your two importance functions should produce the
smaller variance in estimating <span class="math display">\[
\int_{1}^{\infty} \frac{x^2}{\sqrt{2\pi}} e^{-x^2/2} \, dx
\]</span> by importance sampling? Explain.</p>
<div id="solution-4" class="section level3">
<h3>Solution</h3>
<p>è®¾<span class="math display">\[
f_1(x) =  e^{-(x - 1)}, \quad x &gt; 1,
\]</span>ä¸ºåç§»çš„æŒ‡æ•°åˆ†å¸ƒ <span class="math display">\[
f_2(x) = \frac{2}{\sqrt{2\pi}} e^{-\frac{(x - 1)^2}{2}}, \quad x &gt; 1,
\]</span>ä¸ºåŠæ­£æ€åˆ†å¸ƒ</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>f_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="co">#æŒ‡æ•°åˆ†å¸ƒ</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">exp</span>(<span class="sc">-</span>(x<span class="dv">-1</span>)))</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>}</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>f_2 <span class="ot">&lt;-</span> <span class="cf">function</span> (x){<span class="co">#åŠæ­£æ€åˆ†å¸ƒ</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>}</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span> (x){</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  <span class="fu">return</span> (x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>}</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>x_1 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="dv">1</span>) <span class="sc">+</span><span class="dv">1</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>x_2 <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(n,<span class="dv">0</span>)) <span class="sc">+</span><span class="dv">1</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>{</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;é€šè¿‡f_1çš„ä¼°è®¡&quot;</span>,<span class="fu">mean</span>(<span class="fu">g</span>(x_1)<span class="sc">/</span><span class="fu">f_1</span>(x_1)),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;é€šè¿‡f_2çš„ä¼°è®¡&quot;</span>,<span class="fu">mean</span>(<span class="fu">g</span>(x_2)<span class="sc">/</span><span class="fu">f_2</span>(x_2)),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;f_1/â€–f_1â€–-g/â€–gâ€–çš„L1èŒƒæ•°&#39;</span>,<span class="fu">integrate</span>(<span class="cf">function</span>(x) <span class="fu">abs</span>(<span class="fu">f_1</span>(x)<span class="sc">-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">integrate</span>(<span class="cf">function</span>(x) <span class="fu">g</span>(x), <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value), <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;f_2/â€–f_2â€–-g/â€–gâ€–çš„L1èŒƒæ•°&#39;</span>,<span class="fu">integrate</span>(<span class="cf">function</span>(x) <span class="fu">abs</span>(<span class="fu">f_2</span>(x)<span class="sc">-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">integrate</span>(<span class="cf">function</span>(x) <span class="fu">g</span>(x), <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value), <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;é€šè¿‡f_1çš„æ–¹å·®&quot;</span>,<span class="fu">var</span> (<span class="fu">g</span>(x_1)<span class="sc">/</span><span class="fu">f_1</span>(x_1)),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;é€šè¿‡f_2çš„æ–¹å·®&quot;</span>,<span class="fu">var</span> (<span class="fu">g</span>(x_2)<span class="sc">/</span><span class="fu">f_1</span>(x_2)),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## é€šè¿‡f_1çš„ä¼°è®¡ 0.4005716 
## é€šè¿‡f_2çš„ä¼°è®¡ 0.4005987 
## f_1/â€–f_1â€–-g/â€–gâ€–çš„L1èŒƒæ•° 0.3219799 
## f_2/â€–f_2â€–-g/â€–gâ€–çš„L1èŒƒæ•° 0.09188285 
## é€šè¿‡f_1çš„æ–¹å·® 0.02485732 
## é€šè¿‡f_2çš„æ–¹å·® 0.01428746</code></pre>
<p>f_2äº§ç”Ÿçš„ä¼°è®¡æ–¹å·®åº”è¯¥æ›´å°ï¼Œå› ä¸ºåˆ†å¸ƒä¸ŽåŽŸå‡½æ•°æ›´æŽ¥è¿‘ã€‚</p>
</div>
</div>
<div id="å¿«æŽ’ç®—æ³•" class="section level2">
<h2>å¿«æŽ’ç®—æ³•</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>fast_sorting_algorithm <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="co">#å¿«æŽ’ç®—æ³•</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>){</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>    <span class="fu">return</span> (x)}</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  a<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x),<span class="dv">1</span>)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  pivot <span class="ot">&lt;-</span> x [a]</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  left <span class="ot">&lt;-</span> <span class="fu">fast_sorting_algorithm</span>(x[x<span class="sc">&lt;</span>pivot])</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  middle <span class="ot">&lt;-</span> x[x<span class="sc">==</span>pivot]</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>  right <span class="ot">&lt;-</span> <span class="fu">fast_sorting_algorithm</span>(x[x<span class="sc">&gt;</span>pivot])</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">c</span>(left,middle,right))</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>}</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e4</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="fl">1e4</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="fl">1e4</span>, <span class="dv">6</span> <span class="sc">*</span> <span class="fl">1e4</span>, <span class="dv">8</span> <span class="sc">*</span> <span class="fl">1e4</span>)</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>a_n <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>count <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="cf">for</span>(n <span class="cf">in</span> n_values) {</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>  random_nums <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n)</span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>  </span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;n =&quot;</span>, n, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>  temp <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>    start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()  <span class="co"># è®°å½•å¼€å§‹æ—¶é—´</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>    sorted_nums <span class="ot">&lt;-</span> <span class="fu">fast_sorting_algorithm</span>(random_nums)  <span class="co"># å¿«é€ŸæŽ’åº</span></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>    end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()  <span class="co"># è®°å½•ç»“æŸæ—¶é—´</span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> temp <span class="sc">+</span> end_time <span class="sc">-</span> start_time</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>  }</span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a>  a_n[count] <span class="ot">=</span> temp <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;æŽ’åºç”¨æ—¶:&quot;</span>,a_n[count] , <span class="st">&quot;ç§’</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;n*logn=&#39;</span>,n<span class="sc">*</span><span class="fu">log</span>(n),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;-----------------------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## n = 10000 
## æŽ’åºç”¨æ—¶: 0.06667695 ç§’
## n*logn= 92103.4 
## -----------------------
## n = 20000 
## æŽ’åºç”¨æ—¶: 0.1215085 ç§’
## n*logn= 198069.8 
## -----------------------
## n = 40000 
## æŽ’åºç”¨æ—¶: 0.2496439 ç§’
## n*logn= 423865.4 
## -----------------------
## n = 60000 
## æŽ’åºç”¨æ—¶: 0.3658501 ç§’
## n*logn= 660126 
## -----------------------
## n = 80000 
## æŽ’åºç”¨æ—¶: 0.5016288 ç§’
## n*logn= 903182.6 
## -----------------------</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>t_n <span class="ot">&lt;-</span> n_values <span class="sc">*</span> <span class="fu">log</span>(n_values)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(a_n <span class="sc">~</span> t_n)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = a_n ~ t_n)
## 
## Residuals:
##          1          2          3          4          5 
## -0.0001494 -0.0019616  0.0054760 -0.0046096  0.0012446 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.759e-02  3.556e-03   4.947   0.0158 *  
## t_n         5.345e-07  6.539e-09  81.744 4.04e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.004346 on 3 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9994 
## F-statistic:  6682 on 1 and 3 DF,  p-value: 4.035e-06</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(t_n, a_n), <span class="fu">aes</span>(<span class="at">x =</span> t_n, <span class="at">y =</span> a_n)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;n log(n)&quot;</span>,</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;a_n&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw-3" class="section level1">
<h1>HW 3</h1>
<div id="exercise-6.6" class="section level2">
<h2>Exercise 6.6</h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness
<span class="math inline">\(\sqrt{b_1}\)</span> under normality by a
Monte Carlo experiment. Compute the standard error of the estimates from
(2.14) using the normal approximation for the density (with exact
variance formula). Compare the estimated quantiles with the quantiles of
the large sample approximation <span class="math inline">\(\sqrt{b_1}
\approx N(0, \frac{6}{n})\)</span>.</p>
<div id="solution-5" class="section level3">
<h3>Solution</h3>
<p>éšæœºå˜é‡ <span class="math inline">\(X\)</span> çš„ååº¦ä¸ºï¼š</p>
<p><span class="math display">\[
\sqrt{\beta_1} = \operatorname{E}\left[ \left( \frac{X - \mu}{\sigma}
\right)^3 \right]
\]</span> ä½¿ç”¨è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿ<span class="math display">\[
\widehat{\sqrt{\beta_1}} = \frac{1}{n} \sum_{i=1}^{n} \left( \frac{X_i -
\hat{\mu}}{\hat{\sigma}} \right)^3
\]</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># æ ·æœ¬å¤§å°</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># æ¨¡æ‹Ÿæ¬¡æ•°</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co">#è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿ</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(n,t) {</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>  skewness<span class="ot">&lt;-</span> <span class="fu">numeric</span>(t)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>t){</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>    mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>    skewness[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>((x <span class="sc">-</span> mean_x)<span class="sc">^</span><span class="dv">3</span>) <span class="sc">/</span> (n <span class="sc">*</span> s<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>  }</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>  <span class="fu">return</span>(skewness)</span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>}</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>b1_hat <span class="ot">&lt;-</span> <span class="fu">skewness</span>(n,t)</span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co"># è®¡ç®—ååº¦åˆ†ä½æ•°</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a>quant <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a>b1_hat_quant <span class="ot">&lt;-</span> <span class="fu">quantile</span>(b1_hat, <span class="at">probs =</span> quant)</span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a><span class="co">#è®¡ç®—æ ‡å‡†å·®</span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a>b1_density <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(b1_hat_quant, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n))</span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a>b1_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(quant <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> quant) <span class="sc">/</span> (n <span class="sc">*</span> b1_density<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a><span class="co">#å¤§æ ·æœ¬è¿‘ä¼¼åˆ†ä½æ•°</span></span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a>b1_quant <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(quant, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n))</span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb26-28"><a href="#cb26-28" tabindex="-1"></a><span class="fu">rownames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;è’™ç‰¹å¡æ´›ååº¦åˆ†ä½æ•°ä¼°è®¡&#39;</span> , <span class="st">&#39;æ ‡å‡†è¯¯å·®&#39;</span>, <span class="st">&#39;å¤§æ ·æœ¬è¿‘ä¼¼ä¼°è®¡&#39;</span>)</span>
<span id="cb26-29"><a href="#cb26-29" tabindex="-1"></a><span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;2.5%&quot;</span>, <span class="st">&quot;5%&quot;</span>, <span class="st">&quot;95%&quot;</span>,<span class="st">&quot;97.5%&quot;</span>)</span>
<span id="cb26-30"><a href="#cb26-30" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(result)){</span>
<span id="cb26-31"><a href="#cb26-31" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb26-32"><a href="#cb26-32" tabindex="-1"></a>    result[i,] <span class="ot">&lt;-</span> b1_hat_quant}</span>
<span id="cb26-33"><a href="#cb26-33" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb26-34"><a href="#cb26-34" tabindex="-1"></a>    result[i,] <span class="ot">&lt;-</span> b1_se}</span>
<span id="cb26-35"><a href="#cb26-35" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">3</span>){</span>
<span id="cb26-36"><a href="#cb26-36" tabindex="-1"></a>    result[i,] <span class="ot">&lt;-</span> b1_quant}</span>
<span id="cb26-37"><a href="#cb26-37" tabindex="-1"></a>}</span>
<span id="cb26-38"><a href="#cb26-38" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##                                2.5%           5%         95%       97.5%
## è’™ç‰¹å¡æ´›ååº¦åˆ†ä½æ•°ä¼°è®¡ -0.148296906 -0.125168829 0.129685254 0.156856648
## æ ‡å‡†è¯¯å·®                0.005991753  0.004937744 0.005434826 0.007448805
## å¤§æ ·æœ¬è¿‘ä¼¼ä¼°è®¡         -0.151818157 -0.127409814 0.127409814 0.151818157</code></pre>
</div>
</div>
<div id="exercise-6.b" class="section level2">
<h2>Exercise 6.B</h2>
<p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(\rho\)</span>, Spearmanâ€™s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>, or Kendallâ€™s
coefficient <span class="math inline">\(\tau\)</span>, are implemented
in . Show (empirically) that the nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative (a bivariate distribution <span class="math inline">\((X, Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests has better empirical power than the
correlation test against this alternative.</p>
<div id="solution-6" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">library</span>(MASS) </span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>)<span class="co">#åæ–¹å·®é˜µ</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">nrow=</span>t)</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co">#å¯¹å¤šå…ƒæ­£æ€åˆ†å¸ƒ</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>t) {</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="at">n=</span>n, <span class="at">mu=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">Sigma=</span>Sigma)</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>    <span class="co"># Pearsonç›¸å…³æ€§æ£€éªŒ</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>    p_values[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>], data[,<span class="dv">2</span>], <span class="at">method=</span><span class="st">&quot;pearson&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>    <span class="co"># Spearmanç›¸å…³æ€§æ£€éªŒ</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>    p_values[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>], data[,<span class="dv">2</span>], <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>    <span class="co"># Kendallç›¸å…³æ€§æ£€éªŒ</span></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>    p_values[i, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>], data[,<span class="dv">2</span>], <span class="at">method=</span><span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>}</span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a><span class="co">#è®¡ç®—æ£€éªŒåŠŸæ•ˆ</span></span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p_values <span class="sc">&lt;</span> alpha)</span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a><span class="fu">names</span>(power) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Pearson&quot;</span>, <span class="st">&quot;Spearman&quot;</span>, <span class="st">&quot;Kendall&quot;</span>)</span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a><span class="fu">print</span>(power)</span></code></pre></div>
<pre><code>##  Pearson Spearman  Kendall 
##    0.860    0.833    0.831</code></pre>
<p>åœ¨å¤šå…ƒæ­£æ€åˆ†å¸ƒä¸‹ï¼Œçš®å°”é€Šæ£€éªŒè¡¨çŽ°æœ€ä½³ã€‚</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co">#å¯¹éžæ­£æ€åˆ†å¸ƒ</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="co">#xä¸ºæŒ‡æ•°åˆ†å¸ƒï¼Œyä¸ºx/3åŠ ä¸ŠæŒ‡æ•°åˆ†å¸ƒéšæœºæ‰°åŠ¨</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>t) {</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  y <span class="ot">&lt;-</span> x<span class="sc">/</span><span class="dv">3</span> <span class="sc">+</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x,y)</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  <span class="co"># Pearsonç›¸å…³æ€§æ£€éªŒ</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>  p_values[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>], data[,<span class="dv">2</span>], <span class="at">method=</span><span class="st">&quot;pearson&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>  <span class="co"># Spearmanç›¸å…³æ€§æ£€éªŒ</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>  p_values[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>], data[,<span class="dv">2</span>], <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>  <span class="co"># Kendallç›¸å…³æ€§æ£€éªŒ</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>  p_values[i, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(data[,<span class="dv">1</span>], data[,<span class="dv">2</span>], <span class="at">method=</span><span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>}</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p_values <span class="sc">&lt;</span> alpha)</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a><span class="fu">names</span>(power) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Pearson&quot;</span>, <span class="st">&quot;Spearman&quot;</span>, <span class="st">&quot;Kendall&quot;</span>)</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a><span class="fu">print</span>(power)</span></code></pre></div>
<pre><code>##  Pearson Spearman  Kendall 
##    0.883    0.957    0.967</code></pre>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œçš®å°”é€Šæ£€éªŒè¡¨çŽ°ä¸ä½³ã€‚</p>
</div>
</div>
<div id="section" class="section level2">
<h2>3</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. We want to know if the powers are different at 0.05
level.</p>
<p>What is the corresponding hypothesis test problem?</p>
<p>What test should we use? Z-test, two-sample t-test, paired-t test or
McNemar test? Why?</p>
<p>Please provide the least necessary information for hypothesis
testing.</p>
<div id="answer" class="section level3">
<h3>Answer</h3>
<p>(1).åŽŸå‡è®¾<span class="math inline">\(H_0\)</span>:ä¸¤ä¸ªæ–¹æ³•çš„åŠŸæ•ˆæ²¡æœ‰æ˜¾è‘—å·®å¼‚ã€‚
å¤‡æ‹©å‡è®¾<span class="math inline">\(H_1\)</span>:ä¸¤ä¸ªæ–¹æ³•çš„åŠŸæ•ˆå…·æœ‰æ˜¾è‘—å·®å¼‚ã€‚</p>
<p>(2).å‡è®¾é¢˜ç›®æ„æ€æ˜¯åŒä¸€æ•°æ®åˆ†åˆ«ä½¿ç”¨ä¸¤ç§æ–¹æ³•æ£€éªŒï¼Œåº”è¯¥ä½¿ç”¨é…å¯¹tæ£€éªŒã€‚Zæ£€éªŒå‡è®¾æ£€éªŒç»Ÿè®¡é‡æœä»Žæ­£æ€åˆ†å¸ƒï¼Œé€‚åˆæ ·æœ¬é‡éžå¸¸å¤§çš„æƒ…å†µã€‚
ä¸¤æ ·æœ¬tæ£€éªŒé€‚ç”¨ç‹¬ç«‹åŒåˆ†å¸ƒçš„æƒ…å†µï¼ŒåŠŸæ•ˆæ¯”é…å¯¹æ£€éªŒä½Žã€‚McNemaræ£€éªŒé€‚ç”¨äºŽäºŒåˆ†ç±»çš„ç¦»æ•£æ•°æ®ã€‚</p>
<p>(3)éœ€æä¾›ä¸¤ä¸ªæ–¹æ³•çš„å¹³å‡æ£€éªŒåŠŸæ•ˆï¼Œæ–¹å·®ï¼Œå®žéªŒæ¬¡æ•°ã€‚</p>
</div>
</div>
</div>
<div id="hw-4" class="section level1">
<h1>HW 4</h1>
<div id="ex1" class="section level2">
<h2>EX1</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>n_null <span class="ot">&lt;-</span> <span class="dv">950</span>  </span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>n_alt <span class="ot">&lt;-</span> <span class="dv">50</span>  </span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>  </span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>  </span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni correction&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>)</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="fu">rownames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="co">#æ ¡æ­£å‡½æ•°ï¼Œè¿”å›žFWERï¼ŒFDR,TPR</span></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>correction <span class="ot">&lt;-</span> <span class="cf">function</span>(p,method,alpha,n_null,n_alt){</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>  N<span class="ot">=</span>n_null<span class="sc">+</span>n_alt</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>  p_correction <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method=</span>method)</span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>  reject <span class="ot">&lt;-</span> p_correction<span class="sc">&lt;</span>alpha</span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a>  false_pos <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject[<span class="dv">1</span><span class="sc">:</span>n_null])</span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a>  true_pos <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject[(n_null <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N])</span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a>  <span class="cf">if</span> (false_pos<span class="sc">&gt;</span><span class="dv">0</span>){FWER<span class="ot">=</span><span class="dv">1</span>}</span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a>  <span class="cf">else</span> FWER<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a>  FDR <span class="ot">&lt;-</span> false_pos<span class="sc">/</span><span class="fu">sum</span>(reject)</span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a>  TPR <span class="ot">&lt;-</span> true_pos<span class="sc">/</span>n_alt</span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">c</span>(FWER,FDR,TPR))</span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a>}</span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a>  p_null <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_null)  </span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a>  p_alt <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n_alt, <span class="fl">0.1</span>, <span class="dv">1</span>)  </span>
<span id="cb32-28"><a href="#cb32-28" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(p_null, p_alt)</span>
<span id="cb32-29"><a href="#cb32-29" tabindex="-1"></a>  <span class="co">#bonferroniæ ¡æ­£</span></span>
<span id="cb32-30"><a href="#cb32-30" tabindex="-1"></a>  p_bf <span class="ot">&lt;-</span> <span class="fu">correction</span>(p_values,<span class="st">&quot;bonferroni&quot;</span>,alpha,n_null,n_alt)</span>
<span id="cb32-31"><a href="#cb32-31" tabindex="-1"></a>  results[<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;Bonferroni correction&quot;</span>] <span class="ot">&lt;-</span> results[<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;Bonferroni correction&quot;</span>]<span class="sc">+</span>p_bf[<span class="dv">1</span>]</span>
<span id="cb32-32"><a href="#cb32-32" tabindex="-1"></a>  results[<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;Bonferroni correction&quot;</span>] <span class="ot">&lt;-</span> results[<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;Bonferroni correction&quot;</span>]<span class="sc">+</span>p_bf[<span class="dv">2</span>]</span>
<span id="cb32-33"><a href="#cb32-33" tabindex="-1"></a>  results[<span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;Bonferroni correction&quot;</span>] <span class="ot">&lt;-</span> results[<span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;Bonferroni correction&quot;</span>]<span class="sc">+</span>p_bf[<span class="dv">3</span>]</span>
<span id="cb32-34"><a href="#cb32-34" tabindex="-1"></a>  </span>
<span id="cb32-35"><a href="#cb32-35" tabindex="-1"></a>  <span class="co"># B-Hæ ¡æ­£</span></span>
<span id="cb32-36"><a href="#cb32-36" tabindex="-1"></a>  p_bh <span class="ot">&lt;-</span> <span class="fu">correction</span>(p_values,<span class="st">&quot;BH&quot;</span>,alpha,n_null,n_alt)</span>
<span id="cb32-37"><a href="#cb32-37" tabindex="-1"></a>  results[<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>] <span class="ot">&lt;-</span> results[<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>]<span class="sc">+</span>p_bh[<span class="dv">1</span>]</span>
<span id="cb32-38"><a href="#cb32-38" tabindex="-1"></a>  results[<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>] <span class="ot">&lt;-</span> results[<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>]<span class="sc">+</span>p_bh[<span class="dv">2</span>]</span>
<span id="cb32-39"><a href="#cb32-39" tabindex="-1"></a>  results[<span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>] <span class="ot">&lt;-</span> results[<span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>]<span class="sc">+</span>p_bh[<span class="dv">3</span>]</span>
<span id="cb32-40"><a href="#cb32-40" tabindex="-1"></a>}</span>
<span id="cb32-41"><a href="#cb32-41" tabindex="-1"></a></span>
<span id="cb32-42"><a href="#cb32-42" tabindex="-1"></a><span class="co"># è®¡ç®—å¹³å‡å€¼</span></span>
<span id="cb32-43"><a href="#cb32-43" tabindex="-1"></a>results[<span class="st">&quot;FWER&quot;</span>, ] <span class="ot">&lt;-</span> results[<span class="st">&quot;FWER&quot;</span>, ] <span class="sc">/</span> m</span>
<span id="cb32-44"><a href="#cb32-44" tabindex="-1"></a>results[<span class="st">&quot;FDR&quot;</span>, ] <span class="ot">&lt;-</span> results[<span class="st">&quot;FDR&quot;</span>, ] <span class="sc">/</span> m</span>
<span id="cb32-45"><a href="#cb32-45" tabindex="-1"></a>results[<span class="st">&quot;TPR&quot;</span>, ] <span class="ot">&lt;-</span> results[<span class="st">&quot;TPR&quot;</span>, ] <span class="sc">/</span> m</span>
<span id="cb32-46"><a href="#cb32-46" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##      Bonferroni correction B-H correction
## FWER           0.087300000     0.93050000
## FDR            0.004510088     0.09502215
## TPR            0.396736000     0.56106200</code></pre>
<p>Bonferroniæ ¡æ­£å¯¹FDRç‰¹åˆ«ä¸¥æ ¼ï¼Œå¯¼è‡´äº†ä¼˜ç§€çš„FWERå’ŒFDRä½†æ˜¯TPRè¡¨çŽ°è¾ƒå·®ã€‚B-Håˆ™ç›¸åã€‚</p>
</div>
<div id="ex2" class="section level2">
<h2>EX2</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="co">#mleä¼°è®¡</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>mle_lambda <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(data)</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="cf">function</span>(data, i) {</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(data[i]))  </span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>}</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a><span class="co"># bootstrapä¼°è®¡</span></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, lambda, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>boot_bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_results<span class="sc">$</span>t) <span class="sc">-</span> mle_lambda</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>boot_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_results<span class="sc">$</span>t)  </span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>{</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;æœ€å¤§ä¼¼ç„¶ä¼°è®¡ : &quot;</span>, mle_lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;ä¼°è®¡åå·®: &quot;</span>, boot_bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;ä¼°è®¡æ ‡å‡†è¯¯å·®: &quot;</span>, boot_se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)}</span></code></pre></div>
<pre><code>## æœ€å¤§ä¼¼ç„¶ä¼°è®¡ :  0.00925212 
## ä¼°è®¡åå·®:  0.001522954 
## ä¼°è®¡æ ‡å‡†è¯¯å·®:  0.00455203</code></pre>
</div>
<div id="ex3" class="section level2">
<h2>EX3</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>datamean <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) <span class="fu">mean</span>(x[i])</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>data, <span class="at">statistic=</span>datamean, <span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>{</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;standard normal CI: &quot;</span>, ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;basic CI: &quot;</span>, ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;percentile CI: &quot;</span>, ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BCa CI: &quot;</span>, ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)}</span></code></pre></div>
<pre><code>## standard normal CI:  39.03054 179.7016 
## basic CI:  29.18572 166.4979 
## percentile CI:  49.66878 186.9809 
## BCa CI:  60.41442 226.2589</code></pre>
<p>èŽ·å¾—çš„ç»“æžœä¸åŒæ˜¯å› ä¸ºå‡ ç§æ–¹æ³•åŸºäºŽçš„å‡è®¾ä¸åŒã€‚normalåŸºäºŽæ­£æ€å‡è®¾ï¼ŒbasicåŸºäºŽå¤§æ ·æœ¬ï¼Œåˆ†ä½æ•°åŸºäºŽæ¡ä»¶åˆ†å¸ƒç›¸åŒï¼ŒBCaæ ¡å‡†äº†åå·®ã€‚</p>
</div>
</div>
<div id="hw-5" class="section level1">
<h1>HW 5</h1>
<div id="ex-7.8" class="section level2">
<h2>EX 7.8</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a><span class="fu">data</span>(scor)</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>cov_matrix <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cov_matrix)<span class="sc">$</span>values</span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> eigenvalues[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(eigenvalues)</span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a><span class="co">#jacknifeä¼°è®¡</span></span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a>jackknife <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a>  theta_jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a>    eigen_jack <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(data[<span class="sc">-</span>i, ]))<span class="sc">$</span>values</span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a>    theta_jack[i] <span class="ot">&lt;-</span> eigen_jack[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(eigen_jack)</span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a>  }</span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a>  </span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a>  bias_jack <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta_jack) <span class="sc">-</span> theta_hat)</span>
<span id="cb38-21"><a href="#cb38-21" tabindex="-1"></a>  se_jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">mean</span>((theta_jack <span class="sc">-</span> theta_hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb38-22"><a href="#cb38-22" tabindex="-1"></a>  </span>
<span id="cb38-23"><a href="#cb38-23" tabindex="-1"></a>   <span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta_hat,<span class="at">bias_jack=</span>bias_jack,</span>
<span id="cb38-24"><a href="#cb38-24" tabindex="-1"></a> <span class="at">se_jack=</span>se_jack),<span class="dv">3</span>)</span>
<span id="cb38-25"><a href="#cb38-25" tabindex="-1"></a>}</span>
<span id="cb38-26"><a href="#cb38-26" tabindex="-1"></a></span>
<span id="cb38-27"><a href="#cb38-27" tabindex="-1"></a>jackknife_results <span class="ot">&lt;-</span> <span class="fu">jackknife</span>(scor)</span>
<span id="cb38-28"><a href="#cb38-28" tabindex="-1"></a>jackknife_results</span></code></pre></div>
<pre><code>##  original bias_jack   se_jack 
##     0.619     0.001     0.050</code></pre>
</div>
<div id="ex-7.10" class="section level2">
<h2>EX 7.10</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">data</span>(ironslag)</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>magnetic <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>chemical <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>chemical</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>  </span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>  <span class="co"># çº¿æ€§æ¨¡åž‹</span></span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>  e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a>  </span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a>  <span class="co"># äºŒæ¬¡å¤šé¡¹å¼æ¨¡åž‹</span></span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a>  e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a>  </span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a>  <span class="co"># å¯¹æ•°-çº¿æ€§æ¨¡åž‹</span></span>
<span id="cb43-24"><a href="#cb43-24" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb43-25"><a href="#cb43-25" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb43-26"><a href="#cb43-26" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb43-27"><a href="#cb43-27" tabindex="-1"></a>  e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb43-28"><a href="#cb43-28" tabindex="-1"></a>  </span>
<span id="cb43-29"><a href="#cb43-29" tabindex="-1"></a>  <span class="co"># ä¸‰æ¬¡å¤šé¡¹å¼æ¨¡åž‹</span></span>
<span id="cb43-30"><a href="#cb43-30" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb43-31"><a href="#cb43-31" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> </span>
<span id="cb43-32"><a href="#cb43-32" tabindex="-1"></a>           J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb43-33"><a href="#cb43-33" tabindex="-1"></a>  e4[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat4</span>
<span id="cb43-34"><a href="#cb43-34" tabindex="-1"></a>}</span>
<span id="cb43-35"><a href="#cb43-35" tabindex="-1"></a></span>
<span id="cb43-36"><a href="#cb43-36" tabindex="-1"></a><span class="co"># é¢„æµ‹è¯¯å·®</span></span>
<span id="cb43-37"><a href="#cb43-37" tabindex="-1"></a>pred_error <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>)),<span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb43-38"><a href="#cb43-38" tabindex="-1"></a><span class="fu">colnames</span>(pred_error) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Linear&quot;</span>, <span class="st">&quot;Quadratic&quot;</span>, <span class="st">&quot;Log-Linear&quot;</span>, <span class="st">&quot;Cubic&quot;</span>)</span>
<span id="cb43-39"><a href="#cb43-39" tabindex="-1"></a><span class="fu">rownames</span>(pred_error)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&#39;prediction error&#39;</span>)</span>
<span id="cb43-40"><a href="#cb43-40" tabindex="-1"></a>pred_error</span></code></pre></div>
<pre><code>##                    Linear Quadratic Log-Linear    Cubic
## prediction error 19.55644  17.85248   18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="co"># è°ƒæ•´åŽçš„R^2</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">c</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical))<span class="sc">$</span>adj.r.squared,</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>            <span class="fu">summary</span>(<span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">$</span>adj.r.squared,</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>            <span class="fu">summary</span>(<span class="fu">lm</span>(<span class="fu">log</span>(magnetic) <span class="sc">~</span> chemical))<span class="sc">$</span>adj.r.squared,</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>            <span class="fu">summary</span>(<span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">3</span>)))<span class="sc">$</span>adj.r.squared),<span class="at">dim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>))</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a><span class="fu">colnames</span>(r2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Linear&quot;</span>, <span class="st">&quot;Quadratic&quot;</span>, <span class="st">&quot;Log-Linear&quot;</span>, <span class="st">&quot;Cubic&quot;</span>)</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a><span class="fu">rownames</span>(r2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;adjusted R2&quot;</span>)</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>r2</span></code></pre></div>
<pre><code>##                Linear Quadratic Log-Linear     Cubic
## adjusted R2 0.5281545 0.5768151  0.5280556 0.5740396</code></pre>
<p>æ ¹æ®é¢„æµ‹è¯¯å·®ï¼Œé€‰æ‹©äºŒæ¬¡å‡½æ•°æ¨¡åž‹ï¼›æ ¹æ®è°ƒæ•´åŽçš„<span class="math inline">\(R^2\)</span>ï¼Œé€‰æ‹©äºŒæ¬¡å‡½æ•°æ¨¡åž‹ã€‚</p>
</div>
<div id="ex-8.1" class="section level2">
<h2>EX 8.1</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a><span class="fu">data</span>(chickwts)</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>n_x <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>n_y <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> n_x <span class="sc">+</span> n_y</span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>cv_stat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)  </span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a><span class="co">#Cramer-von Misesç»Ÿè®¡é‡</span></span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a>cvm <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data[indices[<span class="dv">1</span><span class="sc">:</span>n_x]]</span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data[indices[(n_x <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n_x <span class="sc">+</span> n_y)]]</span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a>  ecdf_x <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)</span>
<span id="cb47-22"><a href="#cb47-22" tabindex="-1"></a>  ecdf_y <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(y)</span>
<span id="cb47-23"><a href="#cb47-23" tabindex="-1"></a>  W <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> (n_x <span class="sc">*</span> n_y)) <span class="sc">*</span> <span class="fu">sum</span>((<span class="fu">ecdf_x</span>(data) <span class="sc">-</span> <span class="fu">ecdf_y</span>(data))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb47-24"><a href="#cb47-24" tabindex="-1"></a>  <span class="fu">return</span>(W)</span>
<span id="cb47-25"><a href="#cb47-25" tabindex="-1"></a>}</span>
<span id="cb47-26"><a href="#cb47-26" tabindex="-1"></a></span>
<span id="cb47-27"><a href="#cb47-27" tabindex="-1"></a>boot_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(data,cvm, R)</span>
<span id="cb47-28"><a href="#cb47-28" tabindex="-1"></a>W <span class="ot">&lt;-</span> boot_result<span class="sc">$</span>t0</span>
<span id="cb47-29"><a href="#cb47-29" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(boot_result<span class="sc">$</span>t0,boot_result<span class="sc">$</span>t) <span class="sc">&gt;=</span> W)</span>
<span id="cb47-30"><a href="#cb47-30" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" tabindex="-1"></a></span>
<span id="cb47-32"><a href="#cb47-32" tabindex="-1"></a>{<span class="fu">cat</span>(<span class="st">&quot;Cramer-von Misesç»Ÿè®¡é‡ W=&quot;</span>, W, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb47-33"><a href="#cb47-33" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;på€¼:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)}</span></code></pre></div>
<pre><code>## Cramer-von Misesç»Ÿè®¡é‡ W= 0.00362913 
## på€¼: 0.4095904</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">hist</span>(boot_result<span class="sc">$</span>t, <span class="at">main =</span> <span class="st">&quot;Cramer-von Misesç»Ÿè®¡é‡çš„åˆ†å¸ƒ&quot;</span>, </span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;W&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">&quot;scott&quot;</span>)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a><span class="fu">points</span>(W, <span class="dv">0</span>, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
æŽ¥å—åˆ†å¸ƒç›¸åŒã€‚</p>
</div>
<div id="ex-8.2" class="section level2">
<h2>EX 8.2</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a><span class="co"># ç”Ÿæˆæ•°æ®</span></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fl">0.1</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a><span class="co"># Spearmanç§©ç›¸å…³ç³»æ•°</span></span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a>spearman <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a>  d <span class="ot">&lt;-</span> data[indices, ]</span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cor</span>(d[, <span class="dv">1</span>], d[, <span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb50-14"><a href="#cb50-14" tabindex="-1"></a>}</span>
<span id="cb50-15"><a href="#cb50-15" tabindex="-1"></a></span>
<span id="cb50-16"><a href="#cb50-16" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y)</span>
<span id="cb50-17"><a href="#cb50-17" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" tabindex="-1"></a>R<span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb50-19"><a href="#cb50-19" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, spearman, R)</span>
<span id="cb50-20"><a href="#cb50-20" tabindex="-1"></a>spearman_stat <span class="ot">&lt;-</span> boot_results<span class="sc">$</span>t0</span>
<span id="cb50-21"><a href="#cb50-21" tabindex="-1"></a>p_perm <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(boot_results<span class="sc">$</span>t0,boot_results<span class="sc">$</span>t)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(boot_results<span class="sc">$</span>t0))</span>
<span id="cb50-22"><a href="#cb50-22" tabindex="-1"></a>cor_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb50-23"><a href="#cb50-23" tabindex="-1"></a>{<span class="fu">cat</span>(<span class="st">&quot;ç½®æ¢æ£€éªŒçš„på€¼:&quot;</span>, p_perm, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb50-24"><a href="#cb50-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;cor.test æŠ¥å‘Šçš„på€¼:&quot;</span>, cor_test<span class="sc">$</span>p.value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)}</span></code></pre></div>
<pre><code>## ç½®æ¢æ£€éªŒçš„på€¼: 0.7792221 
## cor.test æŠ¥å‘Šçš„på€¼: 0.7456646</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co"># ç»˜åˆ¶åˆ†å¸ƒç›´æ–¹å›¾</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a><span class="fu">hist</span>(boot_results<span class="sc">$</span>t, <span class="at">main =</span> <span class="st">&quot;Spearmanç»Ÿè®¡é‡çš„ç½®æ¢åˆ†å¸ƒ&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Spearman ç»Ÿè®¡é‡&quot;</span>, <span class="at">breaks =</span> <span class="st">&quot;scott&quot;</span>)</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a><span class="fu">points</span>(spearman_stat, <span class="dv">0</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw-6" class="section level1">
<h1>HW 6</h1>
<div id="ex-9.3" class="section level2">
<h2>EX 9.3</h2>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>target_pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (<span class="dv">1</span> <span class="sc">/</span> (pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)))<span class="co">#ç›®æ ‡åˆ†å¸ƒ</span></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a><span class="co"># Metropolis-Hastingsç®—æ³•ï¼Œé‡‡ç”¨æ­£æ€ä½œä¸ºæè®®åˆ†å¸ƒ</span></span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>m_h <span class="ot">&lt;-</span> <span class="cf">function</span>( n) {</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n<span class="sc">+</span><span class="dv">100000</span>)</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>  samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>  </span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>    proposal <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> samples[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>    accept_ratio <span class="ot">&lt;-</span> <span class="fu">target_pdf</span>(proposal) <span class="sc">/</span> <span class="fu">target_pdf</span>(samples[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a>    </span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> accept_ratio)  samples[i] <span class="ot">&lt;-</span> proposal</span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a>    <span class="cf">else</span>  samples[i] <span class="ot">&lt;-</span> samples[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a>  }</span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a>  <span class="fu">return</span>(samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100000</span>)])<span class="co">#èˆå¼ƒå‰1000ä¸ªæ ·æœ¬</span></span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a>}</span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">m_h</span>(n)</span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a></span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a><span class="co"># æ¯”è¾ƒååˆ†ä½æ•°</span></span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a>{<span class="fu">cat</span>(<span class="st">&quot;ç”Ÿæˆæ ·æœ¬çš„ååˆ†ä½æ•°:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(samples,<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)))</span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">æ ‡å‡†æŸ¯è¥¿åˆ†å¸ƒçš„ååˆ†ä½æ•°:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb53-28"><a href="#cb53-28" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)))}</span></code></pre></div>
<pre><code>## ç”Ÿæˆæ ·æœ¬çš„ååˆ†ä½æ•°:
##           0%          10%          20%          30%          40%          50% 
## -111.8609027   -3.0305244   -1.2783809   -0.6215036   -0.2112617    0.0000000 
##          60%          70%          80%          90%         100% 
##    0.1416581    0.5310911    1.1128279    2.4832217   75.7213686 
## 
## æ ‡å‡†æŸ¯è¥¿åˆ†å¸ƒçš„ååˆ†ä½æ•°:
##  [1]       -Inf -3.0776835 -1.3763819 -0.7265425 -0.3249197  0.0000000
##  [7]  0.3249197  0.7265425  1.3763819  3.0776835        Inf</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co">#Gelman-Rubin</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>  chains[[i]] <span class="ot">&lt;-</span> <span class="fu">m_h</span>(n)</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>}</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a><span class="co"># è®¡ç®—æ ·æœ¬å‡å€¼å’Œæ–¹å·®</span></span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>chain_means <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, mean)</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>chain_vars <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, var)</span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>overall_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(chain_means)</span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a><span class="co"># é“¾é—´æ–¹å·®</span></span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>B <span class="ot">&lt;-</span> (n <span class="sc">/</span> (k <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">sum</span>((chain_means <span class="sc">-</span> overall_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a><span class="co"># é“¾å†…æ–¹å·®</span></span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">mean</span>(chain_vars)</span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a><span class="co"># æ€»ä½“æ–¹å·®</span></span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>V <span class="ot">&lt;-</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n) <span class="sc">*</span> W <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> n) <span class="sc">*</span> B</span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a>R_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(V <span class="sc">/</span> W)</span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a><span class="cf">if</span> (R_hat <span class="sc">&lt;</span> <span class="fl">1.2</span>) {</span>
<span id="cb55-22"><a href="#cb55-22" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;é“¾å·²æ”¶æ•›ï¼ŒR_hat=&quot;</span>,R_hat,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb55-23"><a href="#cb55-23" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb55-24"><a href="#cb55-24" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;é“¾æœªæ”¶æ•›ï¼ŒR_hat=&quot;</span>,R_hat,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb55-25"><a href="#cb55-25" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## é“¾å·²æ”¶æ•›ï¼ŒR_hat= 1.00089</code></pre>
</div>
<div id="ex-9.8" class="section level2">
<h2>EX 9.8</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>  </span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>    </span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span>    </span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>iter<span class="ot">&lt;-</span> <span class="dv">5000</span>  </span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a><span class="co">#åˆå§‹åŒ–</span></span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span>  </span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)     </span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a>gibbs <span class="ot">&lt;-</span> <span class="cf">function</span>(iter){</span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> iter, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a>  <span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb57-13"><a href="#cb57-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter) {</span>
<span id="cb57-14"><a href="#cb57-14" tabindex="-1"></a>    <span class="co"># ç”Ÿæˆ x</span></span>
<span id="cb57-15"><a href="#cb57-15" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb57-16"><a href="#cb57-16" tabindex="-1"></a>    <span class="co">#ç”Ÿæˆ y</span></span>
<span id="cb57-17"><a href="#cb57-17" tabindex="-1"></a>    results[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb57-18"><a href="#cb57-18" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb57-19"><a href="#cb57-19" tabindex="-1"></a>  }</span>
<span id="cb57-20"><a href="#cb57-20" tabindex="-1"></a>  <span class="fu">return</span>(results[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>),])</span>
<span id="cb57-21"><a href="#cb57-21" tabindex="-1"></a>}</span>
<span id="cb57-22"><a href="#cb57-22" tabindex="-1"></a></span>
<span id="cb57-23"><a href="#cb57-23" tabindex="-1"></a><span class="co">#Gelman-Rubin</span></span>
<span id="cb57-24"><a href="#cb57-24" tabindex="-1"></a>R_hat<span class="ot">&lt;-</span><span class="cf">function</span>(j){</span>
<span id="cb57-25"><a href="#cb57-25" tabindex="-1"></a>  chains <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb57-26"><a href="#cb57-26" tabindex="-1"></a>  k<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb57-27"><a href="#cb57-27" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb57-28"><a href="#cb57-28" tabindex="-1"></a>    chains[[i]] <span class="ot">&lt;-</span> <span class="fu">gibbs</span>(iter)[ ,j]</span>
<span id="cb57-29"><a href="#cb57-29" tabindex="-1"></a>  }</span>
<span id="cb57-30"><a href="#cb57-30" tabindex="-1"></a>  chain_means <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, mean)</span>
<span id="cb57-31"><a href="#cb57-31" tabindex="-1"></a>  chain_vars <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, var)</span>
<span id="cb57-32"><a href="#cb57-32" tabindex="-1"></a>  overall_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(chain_means)</span>
<span id="cb57-33"><a href="#cb57-33" tabindex="-1"></a>  B <span class="ot">&lt;-</span> (n <span class="sc">/</span> (k <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">sum</span>((chain_means <span class="sc">-</span> overall_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb57-34"><a href="#cb57-34" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(chain_vars)</span>
<span id="cb57-35"><a href="#cb57-35" tabindex="-1"></a>  V <span class="ot">&lt;-</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n) <span class="sc">*</span> W <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> n) <span class="sc">*</span> B</span>
<span id="cb57-36"><a href="#cb57-36" tabindex="-1"></a>  R_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(V <span class="sc">/</span> W)</span>
<span id="cb57-37"><a href="#cb57-37" tabindex="-1"></a>  <span class="fu">return</span>(R_hat)</span>
<span id="cb57-38"><a href="#cb57-38" tabindex="-1"></a>}</span>
<span id="cb57-39"><a href="#cb57-39" tabindex="-1"></a></span>
<span id="cb57-40"><a href="#cb57-40" tabindex="-1"></a></span>
<span id="cb57-41"><a href="#cb57-41" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">R_hat</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">1.2</span>) {</span>
<span id="cb57-42"><a href="#cb57-42" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;é“¾å·²æ”¶æ•›ï¼ŒR_hat(x),R_hat(y)=&quot;</span>,<span class="fu">c</span>(<span class="fu">R_hat</span>(<span class="dv">1</span>),<span class="fu">R_hat</span>(<span class="dv">2</span>)),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb57-43"><a href="#cb57-43" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb57-44"><a href="#cb57-44" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;é“¾æœªæ”¶æ•›ï¼ŒR_hat(x),R_hat(y)=&quot;</span>,<span class="fu">c</span>(<span class="fu">R_hat</span>(<span class="dv">1</span>),<span class="fu">R_hat</span>(<span class="dv">2</span>)),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb57-45"><a href="#cb57-45" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## é“¾å·²æ”¶æ•›ï¼ŒR_hat(x),R_hat(y)= 1.001585 1.003013</code></pre>
</div>
<div id="ex-3" class="section level2">
<h2>EX 3</h2>
<p>è®¾ <span class="math inline">\(q_{ij} = g(x_{t+1} = j \mid x_t =
i)\)</span>ï¼ŒM-H æŠ½æ ·æ–¹æ³•äº§ç”Ÿçš„æ ·æœ¬åºåˆ— <span class="math inline">\(x_0,
x_1, \ldots\)</span> è½¬ç§»æ ¸ä¸º <span class="math display">\[
p_{ij} = q_{ij} \alpha(i, j) + \delta_i(j) (1 - r(i))
\]</span> å…¶ä¸­ <span class="math inline">\(r(i) = j \cdot q_{ij}
\alpha(i, j)\)</span>ï¼Œ<span class="math inline">\(\alpha(i, j) =
\min\{1, \frac{f_j q_{ji}}{f_i q_{ij}}\}\)</span>ï¼Œ<span class="math inline">\(\delta_i(j)\)</span> ä¸º Dirac-delta å‡½æ•°ã€‚</p>
<p>å¯¹<span class="math inline">\(i \neq j\)</span> æœ‰ <span class="math display">\[
f_i q_{ij} \alpha(i, j) = f_i q_{ij} \min\{1, \frac{f_j q_{ji}}{f_i
q_{ij}}\} = f_j q_{ji} \min\{1, \frac{f_i q_{ij}}{f_j q_{ji}}\} = f_j
q_{ji}\alpha(j, i)
\]</span> å¯¹ <span class="math inline">\(i = j\)</span> <span class="math display">\[
f_i \delta_i(j)(1 - r(i)) = f_j \delta_j(i)(1 - r(j))
\]</span> ä»Žè€Œæ»¡è¶³ç»†è‡´å¹³è¡¡æ–¹ç¨‹ <span class="math display">\[
p_{ij} f_i = p_{ji} f_j, \quad \forall i,j
\]</span> å› æ­¤ <span class="math inline">\(f\)</span>
ä¸ºè¯¥é“¾çš„å¹³ç¨³åˆ†å¸ƒã€‚</p>
</div>
</div>
<div id="hw-7" class="section level1">
<h1>HW 7</h1>
<div id="ex-11.3" class="section level2">
<h2>Ex 11.3</h2>
<div id="a" class="section level4">
<h4>(a)</h4>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>k_term <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a, d) {</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>  <span class="co">#å–å¯¹æ•°</span></span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>  term_log <span class="ot">&lt;-</span>  <span class="sc">-</span> (<span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> k <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>              (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>              <span class="fu">lgamma</span>((d <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="fl">1.5</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> d <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a>  term <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span><span class="fu">exp</span>(term_log)</span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a>  <span class="fu">return</span>(term)</span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="b" class="section level4">
<h4>(b)</h4>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>function_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(a, d) {</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>  sum_result <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>  k<span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>  term_log <span class="ot">&lt;-</span>  <span class="sc">-</span> (<span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> k <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>              (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>              <span class="fu">lgamma</span>((d <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="fl">1.5</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> d <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>  term <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span><span class="fu">exp</span>(term_log)</span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(term))</span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="c" class="section level4">
<h4>(c)</h4>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">function_sum</span>(a, d)</span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
</div>
</div>
<div id="ex-11.5" class="section level2">
<h2>Ex 11.5</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>c_k <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k) {</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>  <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>}</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>lhs <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>   <span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>(k <span class="sc">/</span> <span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">sqrt</span>(pi <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>))  <span class="sc">*</span> <span class="fu">integrate</span>(<span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (k <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">^</span>(<span class="sc">-</span>k <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">0</span>, <span class="fu">c_k</span>(a,k<span class="dv">-1</span>))<span class="sc">$</span>value</span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>}</span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>rhs <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>  <span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">sqrt</span>(pi <span class="sc">*</span> k) <span class="sc">*</span> <span class="fu">integrate</span>(<span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">0</span>, <span class="fu">c_k</span>(a,k))<span class="sc">$</span>value</span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a>}</span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a></span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a>solve_a <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb63-18"><a href="#cb63-18" tabindex="-1"></a>  <span class="co"># æ–¹ç¨‹çš„è§£</span></span>
<span id="cb63-19"><a href="#cb63-19" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb63-20"><a href="#cb63-20" tabindex="-1"></a>    <span class="fu">lhs</span>(a,k)<span class="sc">-</span><span class="fu">rhs</span>(a,k)</span>
<span id="cb63-21"><a href="#cb63-21" tabindex="-1"></a>  }</span>
<span id="cb63-22"><a href="#cb63-22" tabindex="-1"></a>  </span>
<span id="cb63-23"><a href="#cb63-23" tabindex="-1"></a>  <span class="co"># ä½¿ç”¨ uniroot æ±‚è§£</span></span>
<span id="cb63-24"><a href="#cb63-24" tabindex="-1"></a>  solution_a <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f, <span class="at">lower =</span> <span class="fl">0.1</span>, <span class="at">upper =</span> <span class="fu">min</span>(<span class="fu">sqrt</span>(k),<span class="dv">2</span>))<span class="sc">$</span>root</span>
<span id="cb63-25"><a href="#cb63-25" tabindex="-1"></a>  <span class="fu">return</span>(solution_a)</span>
<span id="cb63-26"><a href="#cb63-26" tabindex="-1"></a>}</span>
<span id="cb63-27"><a href="#cb63-27" tabindex="-1"></a></span>
<span id="cb63-28"><a href="#cb63-28" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb63-29"><a href="#cb63-29" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">sapply</span>(k_values, solve_a)</span>
<span id="cb63-30"><a href="#cb63-30" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">rbind</span>(k_values,solution))</span></code></pre></div>
<pre><code>##              [,1]     [,2]     [,3]     [,4]     [,5]     [,6]      [,7]
## k_values 4.000000 5.000000 6.000000 7.000000 8.000000 9.000000 10.000000
## solution 1.492105 1.533557 1.562758 1.584409 1.601192 1.614519  1.625385
##               [,8]      [,9]     [,10]    [,11]     [,12]     [,13]     [,14]
## k_values 11.000000 12.000000 13.000000 14.00000 15.000000 16.000000 17.000000
## solution  1.634412  1.642028  1.648543  1.65418  1.659105  1.663444  1.667296
##              [,15]     [,16]     [,17]     [,18]     [,19]     [,20]     [,21]
## k_values 18.000000 19.000000 20.000000 21.000000 22.000000 23.000000 24.000000
## solution  1.670738  1.673834  1.676632  1.679173  1.681492  1.683616  1.685569
##             [,22]      [,23]      [,24]       [,25]
## k_values 25.00000 100.000000 500.000000 1000.000000
## solution  1.68737   1.720607   1.729753    1.730905</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>S_k1 <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (k <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>)), <span class="at">df =</span> k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>}</span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>S_k <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>)), <span class="at">df =</span> k)</span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a>}</span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a>solve_a <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a>  <span class="co"># æ–¹ç¨‹çš„è§£</span></span>
<span id="cb65-12"><a href="#cb65-12" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb65-13"><a href="#cb65-13" tabindex="-1"></a>    <span class="fu">S_k1</span>(a,k)<span class="sc">-</span><span class="fu">S_k</span>(a,k)</span>
<span id="cb65-14"><a href="#cb65-14" tabindex="-1"></a>  }</span>
<span id="cb65-15"><a href="#cb65-15" tabindex="-1"></a>  </span>
<span id="cb65-16"><a href="#cb65-16" tabindex="-1"></a>  <span class="co"># ä½¿ç”¨ uniroot æ±‚è§£</span></span>
<span id="cb65-17"><a href="#cb65-17" tabindex="-1"></a>  solution_a <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f, <span class="at">lower =</span> <span class="fl">0.1</span>, <span class="at">upper =</span> <span class="fu">min</span>(<span class="fu">sqrt</span>(k),<span class="dv">2</span>))<span class="sc">$</span>root</span>
<span id="cb65-18"><a href="#cb65-18" tabindex="-1"></a>  <span class="fu">return</span>(solution_a)</span>
<span id="cb65-19"><a href="#cb65-19" tabindex="-1"></a>}</span>
<span id="cb65-20"><a href="#cb65-20" tabindex="-1"></a></span>
<span id="cb65-21"><a href="#cb65-21" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb65-22"><a href="#cb65-22" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">sapply</span>(k_values, solve_a)</span>
<span id="cb65-23"><a href="#cb65-23" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">rbind</span>(k_values,solution))</span></code></pre></div>
<pre><code>##              [,1]     [,2]     [,3]     [,4]     [,5]     [,6]      [,7]
## k_values 4.000000 5.000000 6.000000 7.000000 8.000000 9.000000 10.000000
## solution 1.492105 1.533557 1.562758 1.584409 1.601192 1.614519  1.625385
##               [,8]      [,9]     [,10]    [,11]     [,12]     [,13]     [,14]
## k_values 11.000000 12.000000 13.000000 14.00000 15.000000 16.000000 17.000000
## solution  1.634412  1.642028  1.648543  1.65418  1.659105  1.663444  1.667296
##              [,15]     [,16]     [,17]     [,18]     [,19]     [,20]     [,21]
## k_values 18.000000 19.000000 20.000000 21.000000 22.000000 23.000000 24.000000
## solution  1.670738  1.673834  1.676632  1.679173  1.681492  1.683616  1.685569
##             [,22]      [,23]      [,24]       [,25]
## k_values 25.00000 100.000000 500.000000 1000.000000
## solution  1.68737   1.720607   1.729753    1.730905</code></pre>
<p>å¯ä»¥å‘çŽ°è§£ç›¸åŒã€‚</p>
</div>
<div id="section-1" class="section level2">
<h2>3</h2>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>observed_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span>  </span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(observed_data)</span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a><span class="co"># E-M ç®—æ³•</span></span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>em <span class="ot">&lt;-</span> <span class="cf">function</span>(data, tau, <span class="at">tol =</span> <span class="fl">1e-6</span>, <span class="at">max_iter =</span> <span class="dv">1000</span>) {</span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>  <span class="co"># åˆå§‹åŒ– lambda</span></span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(data)  <span class="co"># åˆå§‹å€¼</span></span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a>  </span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a>    <span class="co"># Eæ­¥</span></span>
<span id="cb67-12"><a href="#cb67-12" tabindex="-1"></a>    truncated_data <span class="ot">&lt;-</span> data[data <span class="sc">==</span> tau]  </span>
<span id="cb67-13"><a href="#cb67-13" tabindex="-1"></a>    untruncated_data <span class="ot">&lt;-</span> data[data <span class="sc">&lt;</span> tau] </span>
<span id="cb67-14"><a href="#cb67-14" tabindex="-1"></a>    expected_truncated <span class="ot">&lt;-</span> <span class="fu">sum</span>(truncated_data <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> lambda)</span>
<span id="cb67-15"><a href="#cb67-15" tabindex="-1"></a>    </span>
<span id="cb67-16"><a href="#cb67-16" tabindex="-1"></a>    <span class="co"># Mæ­¥</span></span>
<span id="cb67-17"><a href="#cb67-17" tabindex="-1"></a>    lambda_new <span class="ot">&lt;-</span> n <span class="sc">/</span> (<span class="fu">sum</span>(untruncated_data) <span class="sc">+</span> expected_truncated)</span>
<span id="cb67-18"><a href="#cb67-18" tabindex="-1"></a>    </span>
<span id="cb67-19"><a href="#cb67-19" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(lambda <span class="sc">-</span> lambda_new) <span class="sc">&lt;</span> tol) <span class="cf">break</span></span>
<span id="cb67-20"><a href="#cb67-20" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb67-21"><a href="#cb67-21" tabindex="-1"></a>  }</span>
<span id="cb67-22"><a href="#cb67-22" tabindex="-1"></a>  <span class="fu">return</span>(lambda)</span>
<span id="cb67-23"><a href="#cb67-23" tabindex="-1"></a>}</span>
<span id="cb67-24"><a href="#cb67-24" tabindex="-1"></a></span>
<span id="cb67-25"><a href="#cb67-25" tabindex="-1"></a>lambda_em <span class="ot">&lt;-</span> <span class="fu">em</span>(observed_data, tau)</span>
<span id="cb67-26"><a href="#cb67-26" tabindex="-1"></a></span>
<span id="cb67-27"><a href="#cb67-27" tabindex="-1"></a><span class="co"># ä½¿ç”¨è§‚æµ‹æ•°æ®ç›´æŽ¥è®¡ç®— MLE  </span></span>
<span id="cb67-28"><a href="#cb67-28" tabindex="-1"></a>log_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda) {</span>
<span id="cb67-29"><a href="#cb67-29" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">ifelse</span>(observed_data <span class="sc">&lt;</span> tau, <span class="fu">log</span>(lambda) <span class="sc">-</span> lambda <span class="sc">*</span> observed_data, <span class="sc">-</span>lambda <span class="sc">*</span> tau))</span>
<span id="cb67-30"><a href="#cb67-30" tabindex="-1"></a>}</span>
<span id="cb67-31"><a href="#cb67-31" tabindex="-1"></a>mle_result <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="dv">1</span>, log_likelihood, <span class="at">method =</span> <span class="st">&quot;Brent&quot;</span>, <span class="at">lower =</span> <span class="fl">1e-5</span>, <span class="at">upper =</span> <span class="dv">10</span>)</span>
<span id="cb67-32"><a href="#cb67-32" tabindex="-1"></a>lambda_mle<span class="ot">&lt;-</span> mle_result<span class="sc">$</span>par</span>
<span id="cb67-33"><a href="#cb67-33" tabindex="-1"></a></span>
<span id="cb67-34"><a href="#cb67-34" tabindex="-1"></a></span>
<span id="cb67-35"><a href="#cb67-35" tabindex="-1"></a><span class="co"># è¾“å‡ºç»“æžœ</span></span>
<span id="cb67-36"><a href="#cb67-36" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;EM ç®—æ³•ä¼°è®¡çš„ Î»:&quot;</span>, lambda_em, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## EM ç®—æ³•ä¼°è®¡çš„ Î»: 1.037038</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE ä¼°è®¡çš„ Î»:&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MLE ä¼°è®¡çš„ Î»: 1.037037</code></pre>
</div>
</div>
<div id="hw-8" class="section level1">
<h1>HW 8</h1>
<div id="exercises-11.7" class="section level2">
<h2>Exercises 11.7</h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a><span class="fu">library</span>(boot) </span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a><span class="co"># å®šä¹‰çº¦æŸ</span></span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>),  <span class="co"># 2x + y + z &lt;= 2</span></span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>            <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>)) <span class="co"># x - y + 3z &lt;= 3</span></span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a><span class="co"># simplex</span></span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">maxi =</span> <span class="cn">FALSE</span>)</span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;æœ€ä¼˜è§£çš„å€¼ä¸º:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## æœ€ä¼˜è§£çš„å€¼ä¸º:</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>soln)</span></code></pre></div>
<pre><code>## x1 x2 x3 
##  0  0  0</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;ç›®æ ‡å‡½æ•°çš„æœ€å°å€¼ä¸º:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## ç›®æ ‡å‡½æ•°çš„æœ€å°å€¼ä¸º:</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>value)</span></code></pre></div>
<pre><code>## b 
## 0</code></pre>
</div>
<div id="exercises-3-4-5" class="section level2">
<h2>Exercises 3, 4, 5</h2>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a>)</span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="fu">lm</span>(f, <span class="at">data =</span> mtcars))</span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a><span class="fu">print</span>(model_1)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>mtcars[rows, ]</span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>})</span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a>  <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> data)</span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a>}</span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, fit_model)</span>
<span id="cb81-10"><a href="#cb81-10" tabindex="-1"></a><span class="fu">print</span>(model_2)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.71376     -0.04173  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.49773     -0.04302  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.61239     -0.04535  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.01433     -0.03283  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.80625     -0.04608  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.08877     -0.04364  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.15540     -0.03729  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.99505     -0.04579  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.34255     -0.03497  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    31.02192     -0.04474</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>r2_lapply <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(model_1,model_2), rsq)</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a><span class="co"># è¾“å‡º R^2 å€¼</span></span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a><span class="fu">print</span>(r2_lapply)</span></code></pre></div>
<pre><code>##  [1] 0.7183433 0.8596865 0.7809306 0.8838038 0.7582499 0.7646900 0.6918616
##  [8] 0.7622333 0.7554079 0.7741622 0.7248167 0.6312012 0.7147688 0.7411546</code></pre>
</div>
<div id="exercise-3" class="section level2">
<h2>Exercise 3</h2>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a>)</span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="sc">$</span>p.value)</span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a><span class="fu">print</span>(p_values)</span></code></pre></div>
<pre><code>##   [1] 0.780353325 0.891190181 0.599938405 0.343752020 0.279195877 0.611148680
##   [7] 0.898829396 0.896800012 0.540163347 0.217484078 0.434702980 0.363104396
##  [13] 0.109385331 0.695410309 0.519378769 0.591360111 0.033844990 0.789436660
##  [19] 0.047018163 0.725563187 0.021389546 0.833207747 0.054591132 0.370989228
##  [25] 0.003574069 0.022363195 0.087207641 0.380950867 0.361682948 0.831476728
##  [31] 0.838938640 0.351213553 0.424271596 0.991209872 0.266202557 0.876501693
##  [37] 0.881539177 0.605877592 0.916576280 0.793682801 0.567905491 0.155356325
##  [43] 0.694546071 0.730850233 0.769606301 0.928583736 0.572032830 0.894035728
##  [49] 0.591915810 0.269217528 0.354298170 0.200432829 0.146327429 0.429241579
##  [55] 0.435267213 0.684266403 0.010553233 0.827351276 0.520315281 0.683446318
##  [61] 0.774215284 0.860724992 0.534381421 0.940734435 0.896415817 0.383952850
##  [67] 0.455849270 0.672284006 0.613249775 0.944933606 0.327013695 0.190832238
##  [73] 0.220570747 0.082076299 0.426348646 0.679361739 0.605928603 0.161899137
##  [79] 0.754938576 0.330809776 0.670883358 0.324750703 0.671054058 0.096213538
##  [85] 0.116192493 0.631499197 0.923458128 0.625103006 0.310992379 0.072051489
##  [91] 0.946959703 0.363162344 0.353276102 0.464929786 0.270480616 0.305997550
##  [97] 0.824328084 0.715013272 0.318526381 0.958316422</code></pre>
</div>
<div id="exercise-3-1" class="section level2">
<h2>Exercise 3</h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a><span class="fu">print</span>(p_values)</span></code></pre></div>
<pre><code>##   [1] 0.780353325 0.891190181 0.599938405 0.343752020 0.279195877 0.611148680
##   [7] 0.898829396 0.896800012 0.540163347 0.217484078 0.434702980 0.363104396
##  [13] 0.109385331 0.695410309 0.519378769 0.591360111 0.033844990 0.789436660
##  [19] 0.047018163 0.725563187 0.021389546 0.833207747 0.054591132 0.370989228
##  [25] 0.003574069 0.022363195 0.087207641 0.380950867 0.361682948 0.831476728
##  [31] 0.838938640 0.351213553 0.424271596 0.991209872 0.266202557 0.876501693
##  [37] 0.881539177 0.605877592 0.916576280 0.793682801 0.567905491 0.155356325
##  [43] 0.694546071 0.730850233 0.769606301 0.928583736 0.572032830 0.894035728
##  [49] 0.591915810 0.269217528 0.354298170 0.200432829 0.146327429 0.429241579
##  [55] 0.435267213 0.684266403 0.010553233 0.827351276 0.520315281 0.683446318
##  [61] 0.774215284 0.860724992 0.534381421 0.940734435 0.896415817 0.383952850
##  [67] 0.455849270 0.672284006 0.613249775 0.944933606 0.327013695 0.190832238
##  [73] 0.220570747 0.082076299 0.426348646 0.679361739 0.605928603 0.161899137
##  [79] 0.754938576 0.330809776 0.670883358 0.324750703 0.671054058 0.096213538
##  [85] 0.116192493 0.631499197 0.923458128 0.625103006 0.310992379 0.072051489
##  [91] 0.946959703 0.363162344 0.353276102 0.464929786 0.270480616 0.305997550
##  [97] 0.824328084 0.715013272 0.318526381 0.958316422</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>parallel_lapply <span class="ot">&lt;-</span> <span class="cf">function</span>(FUN, x,y, output_type) {</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">Map</span>(FUN, x,y)</span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>  <span class="fu">vapply</span>(results, identity, output_type)</span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>}</span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a></span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">parallel_lapply</span>(<span class="cf">function</span>(x, y) x <span class="sc">+</span> y, a, b, <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a><span class="fu">print</span>(output)</span></code></pre></div>
<pre><code>## [1] 5 7 9</code></pre>
<p>å‚æ•°æœ‰å‡½æ•°ï¼Œè¾“å…¥çš„æ•°ç»„ï¼Œè¾“å‡ºçš„æ ¼å¼.</p>
</div>
<div id="exercise-4" class="section level2">
<h2>Exercise 4</h2>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a>  <span class="co">#åˆ—è”è¡¨</span></span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a>  row_sum <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(contingency_table)</span>
<span id="cb91-8"><a href="#cb91-8" tabindex="-1"></a>  col_sum <span class="ot">&lt;-</span> <span class="fu">colSums</span>(contingency_table)</span>
<span id="cb91-9"><a href="#cb91-9" tabindex="-1"></a>  total_sample_size <span class="ot">&lt;-</span> <span class="fu">sum</span>(contingency_table)</span>
<span id="cb91-10"><a href="#cb91-10" tabindex="-1"></a>  </span>
<span id="cb91-11"><a href="#cb91-11" tabindex="-1"></a>  <span class="co">#è®¡ç®—</span></span>
<span id="cb91-12"><a href="#cb91-12" tabindex="-1"></a>  theoretical_frequency <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_sum, col_sum) <span class="sc">/</span> total_sample_size</span>
<span id="cb91-13"><a href="#cb91-13" tabindex="-1"></a>  chisq_statistic <span class="ot">&lt;-</span> <span class="fu">sum</span>((contingency_table <span class="sc">-</span> theoretical_frequency)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> theoretical_frequency)</span>
<span id="cb91-14"><a href="#cb91-14" tabindex="-1"></a>  df <span class="ot">&lt;-</span> (<span class="fu">nrow</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">ncol</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb91-15"><a href="#cb91-15" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(chisq_statistic, df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb91-16"><a href="#cb91-16" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">p_value =</span> p_value))</span>
<span id="cb91-18"><a href="#cb91-18" tabindex="-1"></a>}</span>
<span id="cb91-19"><a href="#cb91-19" tabindex="-1"></a></span>
<span id="cb91-20"><a href="#cb91-20" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb91-21"><a href="#cb91-21" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb91-22"><a href="#cb91-22" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb91-23"><a href="#cb91-23" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## $p_value
## [1] 0.01735127</code></pre>
</div>
<div id="exercise-5" class="section level2">
<h2>Exercise 5</h2>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>fast_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>  </span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a>  <span class="co">#èŽ·å¾—è§‚æµ‹å€¼èŒƒå›´</span></span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a>  x_vals <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(x))</span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a>  y_vals <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(y))</span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a>  contingency_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(x_vals), <span class="at">ncol =</span> <span class="fu">length</span>(y_vals),</span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a>                               <span class="at">dimnames =</span> <span class="fu">list</span>(x_vals, y_vals))</span>
<span id="cb93-10"><a href="#cb93-10" tabindex="-1"></a>  </span>
<span id="cb93-11"><a href="#cb93-11" tabindex="-1"></a>  x_indices <span class="ot">&lt;-</span> <span class="fu">match</span>(x, x_vals)</span>
<span id="cb93-12"><a href="#cb93-12" tabindex="-1"></a>  y_indices <span class="ot">&lt;-</span> <span class="fu">match</span>(y, y_vals)</span>
<span id="cb93-13"><a href="#cb93-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb93-14"><a href="#cb93-14" tabindex="-1"></a>    contingency_matrix[x_indices[i], y_indices[i]] <span class="ot">&lt;-</span> contingency_matrix[x_indices[i], y_indices[i]] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb93-15"><a href="#cb93-15" tabindex="-1"></a>  }</span>
<span id="cb93-16"><a href="#cb93-16" tabindex="-1"></a>  </span>
<span id="cb93-17"><a href="#cb93-17" tabindex="-1"></a>  <span class="fu">return</span>(contingency_matrix)</span>
<span id="cb93-18"><a href="#cb93-18" tabindex="-1"></a>}</span>
<span id="cb93-19"><a href="#cb93-19" tabindex="-1"></a></span>
<span id="cb93-20"><a href="#cb93-20" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb93-21"><a href="#cb93-21" tabindex="-1"></a></span>
<span id="cb93-22"><a href="#cb93-22" tabindex="-1"></a>  <span class="co">#åˆ—è”è¡¨</span></span>
<span id="cb93-23"><a href="#cb93-23" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb93-24"><a href="#cb93-24" tabindex="-1"></a>  row_sum <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(contingency_table)</span>
<span id="cb93-25"><a href="#cb93-25" tabindex="-1"></a>  col_sum <span class="ot">&lt;-</span> <span class="fu">colSums</span>(contingency_table)</span>
<span id="cb93-26"><a href="#cb93-26" tabindex="-1"></a>  total_sample_size <span class="ot">&lt;-</span> <span class="fu">sum</span>(contingency_table)</span>
<span id="cb93-27"><a href="#cb93-27" tabindex="-1"></a>  </span>
<span id="cb93-28"><a href="#cb93-28" tabindex="-1"></a>  <span class="co">#è®¡ç®—</span></span>
<span id="cb93-29"><a href="#cb93-29" tabindex="-1"></a>  theoretical_frequency <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_sum, col_sum) <span class="sc">/</span> total_sample_size</span>
<span id="cb93-30"><a href="#cb93-30" tabindex="-1"></a>  chisq_statistic <span class="ot">&lt;-</span> <span class="fu">sum</span>((contingency_table <span class="sc">-</span> theoretical_frequency)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> theoretical_frequency)</span>
<span id="cb93-31"><a href="#cb93-31" tabindex="-1"></a>  df <span class="ot">&lt;-</span> (<span class="fu">nrow</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">ncol</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb93-32"><a href="#cb93-32" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(chisq_statistic, df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb93-33"><a href="#cb93-33" tabindex="-1"></a></span>
<span id="cb93-34"><a href="#cb93-34" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">p_value =</span> p_value))</span>
<span id="cb93-35"><a href="#cb93-35" tabindex="-1"></a>}</span>
<span id="cb93-36"><a href="#cb93-36" tabindex="-1"></a></span>
<span id="cb93-37"><a href="#cb93-37" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb93-38"><a href="#cb93-38" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb93-39"><a href="#cb93-39" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb93-40"><a href="#cb93-40" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## $p_value
## [1] 0.01735127</code></pre>
</div>
</div>
<div id="hw-9" class="section level1">
<h1>HW 9</h1>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co">#æ¸…ç©ºå†…å­˜</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a><span class="co">#Rcpp</span></span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;</span></span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" tabindex="-1"></a><span class="st">// [[Rcpp::export]]</span></span>
<span id="cb97-9"><a href="#cb97-9" tabindex="-1"></a><span class="st">NumericMatrix gibbs_sampler(int n, int a, int b,  int N) {</span></span>
<span id="cb97-10"><a href="#cb97-10" tabindex="-1"></a><span class="st">    NumericMatrix samples(N, 2); // å­˜å‚¨ç»“æžœ</span></span>
<span id="cb97-11"><a href="#cb97-11" tabindex="-1"></a><span class="st">    double x = 0; // åˆå§‹åŒ– x</span></span>
<span id="cb97-12"><a href="#cb97-12" tabindex="-1"></a><span class="st">    double y = 1; // åˆå§‹åŒ– y</span></span>
<span id="cb97-13"><a href="#cb97-13" tabindex="-1"></a></span>
<span id="cb97-14"><a href="#cb97-14" tabindex="-1"></a><span class="st">    for (int i = 0; i &lt; N; ++i) {// Gibbsé‡‡æ ·</span></span>
<span id="cb97-15"><a href="#cb97-15" tabindex="-1"></a><span class="st">        x = R::rbinom(n, y);</span></span>
<span id="cb97-16"><a href="#cb97-16" tabindex="-1"></a><span class="st">        y = R::rbeta(x + a, n - x + b);</span></span>
<span id="cb97-17"><a href="#cb97-17" tabindex="-1"></a><span class="st">        samples(i, 0) = x;</span></span>
<span id="cb97-18"><a href="#cb97-18" tabindex="-1"></a><span class="st">        samples(i, 1) = y;</span></span>
<span id="cb97-19"><a href="#cb97-19" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb97-20"><a href="#cb97-20" tabindex="-1"></a><span class="st">    return samples;</span></span>
<span id="cb97-21"><a href="#cb97-21" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb97-22"><a href="#cb97-22" tabindex="-1"></a><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: No function found for Rcpp::export attribute at file86083dd45e80.cpp:5</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>       </span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>        </span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span>        </span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>     </span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a><span class="co">#ç”Ÿæˆæ•°æ®ä¸Žç»˜å›¾</span></span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n, a, b, N)</span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a><span class="fu">plot</span>(samples,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmZmZmtv+QOgCQZgCQ2/+2ZgC2/7a2///bkDrb/9vb////tmb/25D//7b//9v////GkoVkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIXUlEQVR4nO2ccZ/iJhCGs9e9bde23tlLG5Xv/z1rEnUFMvNCgITo+/zh7/aCOHkcBhLRxhCVZu0AaoeCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEyC2o2w1qC8naXAcEFBV2RsoWCRgY5U4YoaKR5eLz+z6iLgkaaQchDVLchR0Ej7hC7/11I0KFpvp/3l/fg7yzdZUGdst05/Z5RZQS17/9dHH035rT7zNBdFrzxYglzh9hdWBFB5/1FS/f204yqUrvLgl9krCjcIl12iJ12l5HVfftlbo9p3WXBKzJOGE6CvWIG2S87NW1ZzZepQYOq5O4CAVXY2BnkVmV7Jf2Ms5i+avGrsHkU5q2kn2Ed5A4Kp18nodwUsYU940raLatOv+7b740h6z+8khQd6MwzaovNYlNCjBHP2J/HbUHSzZ+FMyj+PpTc1cPj/Z9ijdmKoIzdiVXjdtjNIPXv1YZYwe7ArOWmhLQSfIxnOUHDFH9BqEAlZjH/4PTV5/TxhYdY21zXh12z1sVq0MJQXih+/X/wC0YE97B+Xu1SA2TMuhk0XKyOLHmxOn2t8HVQFbRokV4og9ylstVt0JBasQZdU6hkDdJX0tGCjJVw8YHGndFpN76+kD9lVtL2wqbqDFqiu8h5u6oatEh3oApXPsQW6C5WUMi0nxJofYLAxZUnwGg+xXX5lgXZ/Xi3COMy6PkEoavPuBokXvpuWJB7y5Wz2EQX2TLIG3HRgVYnyK9BLy/IGVKRC0X0sc/2BelDihmUeIMHNjePCTUj0PUFpaXERjKouTPjqcZ6j59TUFx3VsT+GRpNWKSgTV6L2VX5NYZYTHfOQqfwEJOiqkqQ/RZ6gjJnkHn0vYlLDXeh49y/yD3NG0vQBqZ5L8vdGmRMziGm3z7SAp1meUF578JHNtcCDT6jFHIIMlpGxQrSowpgiRpkv4d5UwIOMWPpVgMNPqME1hfkZpDlSw80+IwSCBliSwrawi3XdQU5izAt0GnuDU+7fod4EMcPaZt0BYKkMYUDhQ3bS9fCnoSR2yfzPRHbX/y3NKMg0LvIzCEGHF03dcRl0KpFWmR2DWrl7DB9DvX7OiKHWN6FzaqCuqb/FsZ5L+5uMebw9rOyGmQ0/SIzBPUVZjQj7a8baJvPugTpwiICBQ1Pu+GLYJjjx28vO8TCOO/Fb0NVUKQLTvM5mF6UWe9oWUHi0jkk0KSGNlHf9llUkLR0Dgk0qaHeyx3poNdW+DN1FguOOHvD2d2lFhXQPLDmBASa2HB2d4UFiYkbHWhiw4E53/YpO827AziUMoJmfdvnhYbYvO9qlBYUexZioIkNTfi3feycfyFBgRk0VSQK1qDIk3h4Wt6GPUHf9klNCdDcqzl2voZSaBYL+bZPYUFuBs1kxXUQukNDQcwgvTsKAt2VFnR7SA40c8Pg7igIdMchBrrjLAa6K5tBc6/eJwLN3DC4u2RBxk5Ad+mcxc+mBenC8gWauWFwd7kFzbzhgwPN3DC4u8I1KF+gmRvqvdyhINgdBYHuYgU5NQYto/IFmrlhcHepGeQJe3lBRs0YCnIFTP1JQRxiEYLssLhQhBl0e8gdaOaGwd3FCvIuRp2oioywLQlyZzFvSJXwsylBeg0qxHYEedN6ibAmA83ccCBkf1DuGlSGMoKC9gdFC3LDKFJzJgLN3NCE7u5IFrQIRQSF7Q+KrkGRUeShpgyauOveLD6kXErVoFn7g24PX/+zghGHQrNYjv1BdVDROqjQtUIiNQmqYki5lBakfJmlziHlsnAGNXcoCHe3BT+rCqqy5riseLG6DVa7WN0MJQQFXGqEdQqOpx1OfXpC84CL1bBOn1UQMwiBL1bDOn1aQfhiNazT5xWUqVMKSjtOQRSUdvz5BT0TFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCJBfUNc02q/CDh+tqTdszUG5YXn8aNRfTu9/7ln8IdXjH78CIrTJLqi7vHYnv/55fznWqufYKXd0u8uh005+dtu/umTotBs+iwEROuQWNH7ycRBPYfypZWlzSM9pJwsae5effd5/l1+9Gz8RRhE65BaEBfRob2D7/kMUdPxdf+M1QV3zOXyaFxbhneyChlPQP1e8nIJ8/NKBXIO6b//s1AqmDrExrLAI7+QWNOYGGOLKx2r9AJAFtf0gGdNE7FopwIOVoAi/WENQp9To/iNbRdAbePf71Dx+SPprEBSQwNrHssPTFUFDv/Jv6oP6UsMQwyWwVWvIdXOKYGA8LblUg+yooUjDSbSV13E35Awa95fI7/548uLxroJpHi3D5ALxhbKS7kvUwyYT/6m4Bq28UBxGibbKGYeQGp92qdGBC5WDdvyaWnqEDrxYBVAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAWoX1O8EO+3wnqJi1C6o3y2l/xZPYWoX1G+N/jN4t1MBqhdkDuoXO4pTvyB54/wiVC/ovP8rdMduEaoX1L7/q+xqLU/tgvqd0cG74ktQu6DDsDF6xTJdu6DVoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAP8DgVojydhuFXkAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a>gibbs_sampler_r <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, num_steps) {</span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> num_steps, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>  <span class="co"># Gibbsé‡‡æ ·</span></span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_steps) {</span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> y)</span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="at">shape1 =</span> x <span class="sc">+</span> a, <span class="at">shape2 =</span> n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb100-9"><a href="#cb100-9" tabindex="-1"></a>    samples[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb100-10"><a href="#cb100-10" tabindex="-1"></a>  }</span>
<span id="cb100-11"><a href="#cb100-11" tabindex="-1"></a>  samples</span>
<span id="cb100-12"><a href="#cb100-12" tabindex="-1"></a>}</span>
<span id="cb100-13"><a href="#cb100-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb100-14"><a href="#cb100-14" tabindex="-1"></a>samples_rcpp <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n, a, b, N)</span>
<span id="cb100-15"><a href="#cb100-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb100-16"><a href="#cb100-16" tabindex="-1"></a>samples_r <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler_r</span>(n, a, b, N)</span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="co"># æ¯”è¾ƒQQå›¾</span></span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a><span class="fu">qqplot</span>(</span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a>  samples_r[,<span class="dv">1</span>], samples_rcpp[,<span class="dv">1</span>],</span>
<span id="cb101-4"><a href="#cb101-4" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;x QQ Plot&quot;</span>,</span>
<span id="cb101-5"><a href="#cb101-5" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;OracleR_x&quot;</span>,</span>
<span id="cb101-6"><a href="#cb101-6" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Rcpp_x&quot;</span></span>
<span id="cb101-7"><a href="#cb101-7" tabindex="-1"></a>)</span>
<span id="cb101-8"><a href="#cb101-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="co"># QQ plot comparison for y</span></span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a><span class="fu">qqplot</span>(</span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>  samples_r[,<span class="dv">2</span>], samples_rcpp[,<span class="dv">2</span>],</span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;y QQ Plot&quot;</span>,</span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;OracleR_y&quot;</span>,</span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Rcpp_y&quot;</span></span>
<span id="cb102-7"><a href="#cb102-7" tabindex="-1"></a>)</span>
<span id="cb102-8"><a href="#cb102-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAnFBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZjpmkGZmkLZmkNtmtttmtv+QOgCQOjqQZgCQkGaQtpCQ27aQ2/+2ZgC2Zjq2ZpC225C22/+2///bkDrbkJDbtpDb27bb////tmb/25D/27b//7b//9v///9wfg8PAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKZUlEQVR4nO2de2PaNhTFRdM1bN0rpHuGvUK31utCCvf7f7fpZWMbm2O9LOHc80eCiLiyfzlXkkEWglgXJXIfQOliQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBBQQYCOn34QQrz99WmwKFUJo68/yL9uxZun3uv//pjgqMoBdHhnz/+LDwNFpRqQWD0OAPr87tWiAckzrqVOtFfUagBJNueAdmJJgOT53arfeyEezDPy7FcqnT6thbg7K9oqGsHnjbRQDUjl4eufnxSfNst4yuUge7LNv12esEwcpcPGGKRd7LxG/m4AVbWjFgfoea2sI8/+1pRPj+Sprh57RfPIAvpvI38bQDKK/Flpky0rxWyOnTJMnuopk1aPvWL9qN8H7Vo+XBggY4ddkz5OgOpRrO6IdJWlAVI5JhOpxmBzqvpOnfWrj72iqWMBrb6t50F1ImojLg2QyrGTOWwnLc949aNoOummaOpULQTLd5A6q69acxk9rsvZnvLI3VnRVukBWnQfpHLsdO46x05d8FlR6xxQexRr2TGm8gFSc+X2//zzu6YPVhO/XlHpHFBrHqQ6oiXNg0if0W27bK9Of7Jz516RBgGZmfQv+pn37eu2aMoL6GHo+eP7b57Gi3MrHyCZQ0l61cjKBUh3wne4XnZlBLT6PlPbTirm/aBSxYCAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBBQZEDiWnSTC1DccAkk4RDd3Ew+0BcGSONR9mFAgzJ4lH0Y0ICESS9BDGhQpnO+IQY0LOkeyUeYPEsFaCfErb4XcHB5qnO4OaXSS/Y+Js1SAar06v9btcJwZP1lqYA0lxs7iuknJr/SoZXjVmLZ6wX/Vf+WY49w80lhsb1PfYBJAB02MrP2enHzfmSJc5GAbO/TpJd+bvKLHRq6TgcJ2/tQm0/qPkijCg43h4RJL+Oi9vOTAzg1d3WjmO19NJ7OsfE8SMn0Or3ex/5pcozIhxQ3XJiaqfMZnvSAqvJHMfu+z3l2mb9ODhPxYIb+U9lk7TN2VC89xRr7jP3TXjigtn1GakwO5dRwvWnN6K2CRQCC9qFkE8X6HsH92M2CJQACvY+tNDmaQ8ut+XO5lxpT7EMpL1aNSr1YFbj3sRUnR3RovXwHTbQPpeuDrIUK7YOm2oeSjWL1jhoj/skLaLp96EXOgyYNXqfak8MGHVTqcA4NO+F5cYA62TXpGNwBtfadC1AeQK72IT8Hqb14QnfTyAHI3T7knWLBjDIA8rAPBfRB1aVL0YjtxpKXfcgXkNrl6kFOmEenOfHajSQ/+5AXIDUJNGTGLrRithtFTlPD3kudKx42MTaRmxWQt30ocB50/M0b1YyAAuxDLwFQiH1o+YB8B69TgJCK7oBEI8cXeirQPrRwB4X1PjZGSMXCAYXbh5YMKIZ9aLmARBT70GIBBQ9ep0jRK2YJ1wseyz7kB0i/I+9/nerWrk/sOL2PDeZe0a7ODLsiSwgoon3IB9Bxaz7z2gV5KBmgqPYhr6v5e2OdgPc6XNp1DBvXPhTioLEPlSO36xY1sn3Irw/SnytXoyt847brEjO6fcjzY59GIMue16MQEwBKYB9KtvwFMowOKIl9KNVE0S7qmNFBaexDySaKh436+2yAUtmHEk4Ud/LvcwFKZh9KOVGsxN08gDr2iRe2ju5ccfJE8Xn9eg5AKe1DaSeKx+34XCnaNCVd72MbcK9Y0kQxsX0o8USREt/tk9w+NPsbZie20YIlxXPN7yjOYR/yA6QG+NEF0LHbHQ0wh33IC5CZAB02l1Yqpr7bZyb7kF8nbYavS/Og1Hf7zGUf8psHmXMeG58o+b0a89mHvFLMzICe1+OdUNq7fWa0D/l10vqLTy9dq6Z0UNorr4H2oldUSne3z7z2oSBA/16YRie622fW3sc26VqxsmP3cTv/xz6z24fcAal3y8xEcfaV9hnsQ86Ajlu979ZD8BdKu59gDvuQMyC9J9lx+zb4hh/XU8xjH/IApIanXfhX57qdo8hkH/IFFLj2xaVdXXnmuU+nbbeKFlD4HXUO55nRPnQNgHLah8oHlNc+5AFINJpjopjZPlT4W67Z7UNlA8pvHyr5U41sU8PeYUSvGClcAdlljiN6xSjhCrEPlQqoFPtQoYCKsQ8VCagg+1CBgMrpfezxRK8YFq4s+1BpgEqzDxUGqDj7UFGACrQPlQSoRPtQOYDKtA8lA+S6PqhQ+1C6z+ad1gcVax9KBMhxdUe59qFEgJzWB5VsHyrAQUXbh7KvD+rYx6WF2ZRoFJu2PkiUbh/KOw8q3z6UFZDhUjae9IAu3MxyBfahrB/76N5n8Pt0SlLOPqh8+1BWQDd0BXzyXazeTP6e8rzKdbF6I65FKQBNuNSYGjNKlTjtRIww4WJ1asxlAmIHIeGL1akxFwoIX6xOjblUQNFiMqA5qjCgWdpJHsEr5ssGtCgxICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQUERA+/b2TPvLezVNjEKeux10gqgv/vTfXjQeILWBzL4+rE7BO4oq+3wVSieI2gB6708oGiDzkYe99b5T8I5C+k1wd0C9Q7n1OxSraIDMJtN2WUyn4B1FPXrzuzugTpByAH2pLG0/UOwUvKPookcf1A1SSoqZnLeZ3yl4R9G54gGo17r3eKFVNCD1+W0woJ100qXdIYFKTjFdCE0x7+7QquROurIrVVz7j04QbzNbFT7MezmoE8TQ8v/Oq9Inil4z6U6QUvognRHqoMzEo/IdOjpRyPNSoxNkJ0I2h+SLVSAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgPID0l/vOr7CpbVhSLM7T/D3xDkoOyC93cXzenSlTBeQrhaw4tBduQGZ1WDmSxYHNQCoWfkxh3IDqtdKVW+eDvd/qK2tdnXGqQVmtwZQZfKqJtNeEqMDVOmIZQbUOGe/ejxs1HmrE1Yrd/UP+WcFSD1Ua6CGHKTWjh236XIuOyB7as/rBw3rcP9ols3V6GQN81CSsGSqdh+kItg8TaKiADW7E0kCZm2hrmFW08kn6lGs4xdpuYvbPQUqO6B2iunFqUK8+md9coUCVK921Q7qj3jSWbuE435JnfTmwS5KVT/OHER159Pb/upw/9d9ugzLDshyUE7SgPR6XTXR6fRBNqdsH7TrLA89bt8mzLDsgFoTxcZBh43yiBq6JJF6FFNYLCAz3LUipJxZZwd0utRo+qDVo/ZIbx6kh3OTkF0kKcewEgAF6/mbhBm2BEBV0mvXKwWk81Jp9ec6ZRd9tYDmEwMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQH9D4oKAT7WELuwAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="co">#æ¯”è¾ƒè¿è¡Œæ—¶é—´</span></span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>benchmark_results <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>  samples_rcpp <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n, a, b, N),</span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>  samples_r <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler_r</span>(n, a, b, N),</span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">100</span> </span>
<span id="cb105-6"><a href="#cb105-6" tabindex="-1"></a>)</span>
<span id="cb105-7"><a href="#cb105-7" tabindex="-1"></a><span class="fu">print</span>(benchmark_results)</span></code></pre></div>
<pre><code>## Unit: microseconds
##                                       expr    min      lq     mean  median
##  samples_rcpp &lt;- gibbs_sampler(n, a, b, N)  316.6  330.25  360.666  343.95
##   samples_r &lt;- gibbs_sampler_r(n, a, b, N) 2728.6 2820.95 3363.236 3107.90
##      uq    max neval
##   390.6  458.7   100
##  3549.5 6485.9   100</code></pre>
<p>ä»ŽQQå›¾ä¸­å¯ä»¥å‘çŽ°ä½¿ç”¨rcppç¼–å†™çš„Gibbsç®—æ³•ä¸Žè‡ªå¸¦çš„ç®—æ³•ç»™å‡ºçš„ç»“æžœç›¸ä¼¼ã€‚rcppè¿ç®—è€—æ—¶åœ¨è‡ªå¸¦ç®—æ³•çš„1/10å·¦å³ã€‚</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
